
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Java中的各种加密算法 BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC · mynotes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        <meta name="author" content="morya">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    算法
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="java的各种加密算法.html">
            
                <a href="java的各种加密算法.html">
            
                    
                    Java中的各种加密算法 BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    OS
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    ubuntu
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../mac系统制作ubuntu启动盘.html">
            
                <a href="../mac系统制作ubuntu启动盘.html">
            
                    
                    mac系统制作ubuntu启动盘
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    DevOps工具
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    gitlab
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../devops/gitlab/install-gitlab-on-ubuntu.md">
            
                <span>
            
                    
                    ubuntu 14 安装gitlab
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../devops/gitlab/backup-and-restore.html">
            
                <a href="../devops/gitlab/backup-and-restore.html">
            
                    
                    gitlab-backup-and-restore 备份和恢复
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    ELK
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../elk/elk-config.html">
            
                <a href="../elk/elk-config.html">
            
                    
                    ELK配置汇总
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Java中的各种加密算法 BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-anchor"></i><ul><li><span class="title-icon "></span><a href="#1-&#x5404;&#x79CD;java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;-base64-md5-sha-hmac-des-pbe-rsa-dh-dsa-ecc"><b>1. </b>&#x5404;&#x79CD;Java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5; BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC</a></li><ul><li><span class="title-icon "></span><a href="#11-base64"><b>1.1. </b>BASE64</a></li><li><span class="title-icon "></span><a href="#12-md5"><b>1.2. </b>MD5</a></li><li><span class="title-icon "></span><a href="#13-sha"><b>1.3. </b>SHA</a></li><li><span class="title-icon "></span><a href="#14-hmac"><b>1.4. </b>HMAC</a></li><li><span class="title-icon "></span><a href="#15-des"><b>1.5. </b>DES</a></li><li><span class="title-icon "></span><a href="#16-pbe"><b>1.6. </b>PBE</a></li><li><span class="title-icon "></span><a href="#17-rsa"><b>1.7. </b>RSA</a></li><li><span class="title-icon "></span><a href="#18-dh"><b>1.8. </b>DH</a></li><li><span class="title-icon "></span><a href="#19-dsa"><b>1.9. </b>DSA</a></li><li><span class="title-icon "></span><a href="#110-ecc"><b>1.10. </b>ECC</a></li></ul></ul></div><a href="#1-&#x5404;&#x79CD;java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;-base64-md5-sha-hmac-des-pbe-rsa-dh-dsa-ecc" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="1-&#x5404;&#x79CD;java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;-base64-md5-sha-hmac-des-pbe-rsa-dh-dsa-ecc"><a name="1-&#x5404;&#x79CD;java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;-base64-md5-sha-hmac-des-pbe-rsa-dh-dsa-ecc" class="anchor-navigation-ex-anchor" href="#1-&#x5404;&#x79CD;java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;-base64-md5-sha-hmac-des-pbe-rsa-dh-dsa-ecc"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x5404;&#x79CD;Java&#x52A0;&#x5BC6;&#x7B97;&#x6CD5; BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC</h1>
<p><a href="http://www.open-open.com/lib/view/open1397274257325.html" target="_blank">&#x539F;&#x6587;&#x94FE;&#x63A5;</a></p>
<p>&#x57FA;&#x672C;&#x7684;&#x5355;&#x5411;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</p>
<ul>
<li>BASE64 &#x4E25;&#x683C;&#x5730;&#x8BF4;&#xFF0C;&#x5C5E;&#x4E8E;&#x7F16;&#x7801;&#x683C;&#x5F0F;&#xFF0C;&#x800C;&#x975E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</li>
<li>MD5(Message Digest algorithm 5&#xFF0C;&#x4FE1;&#x606F;&#x6458;&#x8981;&#x7B97;&#x6CD5;)</li>
<li>SHA(Secure Hash Algorithm&#xFF0C;&#x5B89;&#x5168;&#x6563;&#x5217;&#x7B97;&#x6CD5;)</li>
<li>HMAC(Hash Message Authentication Code&#xFF0C;&#x6563;&#x5217;&#x6D88;&#x606F;&#x9274;&#x522B;&#x7801;)</li>
</ul>
<p>&#x590D;&#x6742;&#x7684;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#xFF08;DES&#x3001;PBE&#xFF09;&#x3001;&#x975E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF1A; </p>
<ul>
<li>DES(Data Encryption Standard&#xFF0C;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;)</li>
<li>PBE(Password-based encryption&#xFF0C;&#x57FA;&#x4E8E;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;)</li>
<li>RSA(&#x7B97;&#x6CD5;&#x7684;&#x540D;&#x5B57;&#x4EE5;&#x53D1;&#x660E;&#x8005;&#x7684;&#x540D;&#x5B57;&#x547D;&#x540D;&#xFF1A;Ron Rivest, AdiShamir &#x548C;Leonard Adleman)</li>
<li>DH(Diffie-Hellman&#x7B97;&#x6CD5;&#xFF0C;&#x5BC6;&#x94A5;&#x4E00;&#x81F4;&#x534F;&#x8BAE;)</li>
<li>DSA(Digital Signature Algorithm&#xFF0C;&#x6570;&#x5B57;&#x7B7E;&#x540D;)</li>
<li>ECC(Elliptic Curves Cryptography&#xFF0C;&#x692D;&#x5706;&#x66F2;&#x7EBF;&#x5BC6;&#x7801;&#x7F16;&#x7801;&#x5B66;)</li>
</ul>
<p>&#x672C;&#x7BC7;&#x5185;&#x5BB9;&#x7B80;&#x8981;&#x4ECB;&#x7ECD;BASE64&#x3001;MD5&#x3001;SHA&#x3001;HMAC&#x51E0;&#x79CD;&#x65B9;&#x6CD5;&#x3002; 
MD5&#x3001;SHA&#x3001;HMAC&#x8FD9;&#x4E09;&#x79CD;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x53EF;&#x8C13;&#x662F;&#x975E;&#x53EF;&#x9006;&#x52A0;&#x5BC6;&#xFF0C;&#x5C31;&#x662F;&#x4E0D;&#x53EF;&#x89E3;&#x5BC6;&#x7684;&#x52A0;&#x5BC6;&#x65B9;&#x6CD5;&#x3002;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x53EA;&#x628A;&#x4ED6;&#x4EEC;&#x4F5C;&#x4E3A;&#x52A0;&#x5BC6;&#x7684;&#x57FA;&#x7840;&#x3002;&#x5355;&#x7EAF;&#x7684;&#x4EE5;&#x4E0A;&#x4E09;&#x79CD;&#x7684;&#x52A0;&#x5BC6;&#x5E76;&#x4E0D;&#x53EF;&#x9760;&#x3002; </p>
<h2 id="11-base64"><a name="11-base64" class="anchor-navigation-ex-anchor" href="#11-base64"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. BASE64</h2>
<p>&#x6309; &#x7167;RFC2045&#x7684;&#x5B9A;&#x4E49;&#xFF0C;Base64&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;&#xFF1A;</p>
<p>Base64&#x5185;&#x5BB9;&#x4F20;&#x9001;&#x7F16;&#x7801;&#x88AB;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x628A;&#x4EFB;&#x610F;&#x5E8F;&#x5217;&#x7684;8&#x4F4D;&#x5B57;&#x8282;&#x63CF;&#x8FF0;&#x4E3A;&#x4E00;&#x79CD;&#x4E0D;&#x6613;&#x88AB;&#x4EBA;&#x76F4;&#x63A5;&#x8BC6;&#x522B;&#x7684;&#x5F62;&#x5F0F;&#x3002;</p>
<p>&#xFF08;The Base64 Content-Transfer-Encoding is designed to represent arbitrary sequences of octets in a form that need not be humanly readable.&#xFF09; </p>
<p>&#x5E38;&#x89C1;&#x4E8E;&#x90AE;&#x4EF6;&#x3001;http&#x52A0;&#x5BC6;&#xFF0C;&#x622A;&#x53D6;http&#x4FE1;&#x606F;&#xFF0C;&#x4F60;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#x767B;&#x5F55;&#x64CD;&#x4F5C;&#x7684;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;&#x5B57;&#x6BB5;&#x901A;&#x8FC7;BASE64&#x52A0;&#x5BC6;&#x7684;&#x3002;</p>
<p><img src="images/001-base64.jpg" alt="001-base64"></p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java">    <span class="hljs-comment">/**
    * BASE64&#x89E3;&#x5BC6;
    * 
    * <span class="hljs-doctag">@param</span> key
    * <span class="hljs-doctag">@return</span>
    * <span class="hljs-doctag">@throws</span> Exception
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptBASE64(String key) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> BASE64Decoder()).decodeBuffer(key);
    }

    <span class="hljs-comment">/**
    * BASE64&#x52A0;&#x5BC6;
    * 
    * <span class="hljs-doctag">@param</span> key
    * <span class="hljs-doctag">@return</span>
    * <span class="hljs-doctag">@throws</span> Exception
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">encryptBASE64</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] key)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> BASE64Encoder()).encodeBuffer(key);
    }
</code></pre>
<p>&#x4E3B;&#x8981;&#x5C31;&#x662F;BASE64Encoder&#x3001;BASE64Decoder&#x4E24;&#x4E2A;&#x7C7B;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x77E5;&#x9053;&#x4F7F;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;&#x53E6;&#xFF0C;BASE&#x52A0;&#x5BC6;&#x540E;&#x4EA7;&#x751F;&#x7684;&#x5B57;&#x8282;&#x4F4D;&#x6570;&#x662F;8&#x7684;&#x500D;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x591F;&#x4F4D;&#x6570;&#x4EE5;=&#x7B26;&#x53F7;&#x586B;&#x5145;&#x3002; </p>
<h2 id="12-md5"><a name="12-md5" class="anchor-navigation-ex-anchor" href="#12-md5"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. MD5</h2>
<p>MD5 -- message-digest algorithm 5 </p>
<p>&#xFF08;&#x4FE1;&#x606F;-&#x6458;&#x8981;&#x7B97;&#x6CD5;&#xFF09;&#x7F29;&#x5199;&#xFF0C;&#x5E7F;&#x6CDB;&#x7528;&#x4E8E;&#x52A0;&#x5BC6;&#x548C;&#x89E3;&#x5BC6;&#x6280;&#x672F;&#xFF0C;&#x5E38;&#x7528;&#x4E8E;&#x6587;&#x4EF6;&#x6821;&#x9A8C;&#x3002;&#x6821;&#x9A8C;&#xFF1F;&#x4E0D;&#x7BA1;&#x6587;&#x4EF6;&#x591A;&#x5927;&#xFF0C;&#x7ECF;&#x8FC7;MD5&#x540E;&#x90FD;&#x80FD;&#x751F;&#x6210;&#x552F;&#x4E00;&#x7684;MD5&#x503C;&#x3002;
&#x597D;&#x6BD4;&#x73B0;&#x5728;&#x7684;ISO&#x6821;&#x9A8C;&#xFF0C;&#x90FD; &#x662F;MD5&#x6821;&#x9A8C;&#x3002;&#x600E;&#x4E48;&#x7528;&#xFF1F;&#x5F53;&#x7136;&#x662F;&#x628A;ISO&#x7ECF;&#x8FC7;MD5&#x540E;&#x4EA7;&#x751F;MD5&#x7684;&#x503C;&#x3002;
&#x4E00;&#x822C;&#x4E0B;&#x8F7D;linux-ISO&#x7684;&#x670B;&#x53CB;&#x90FD;&#x89C1;&#x8FC7;&#x4E0B;&#x8F7D;&#x94FE;&#x63A5;&#x65C1;&#x8FB9;&#x653E;&#x7740;MD5&#x7684;&#x4E32;&#x3002;&#x5C31;&#x662F;&#x7528;&#x6765;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x4E00;&#x81F4;&#x7684;&#x3002; </p>
<p><img src="images/002-md5.jpg" alt="002-md5"></p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java">    <span class="hljs-comment">/**
    * MD5&#x52A0;&#x5BC6;
    * 
    * <span class="hljs-doctag">@param</span> data
    * <span class="hljs-doctag">@return</span>
    * <span class="hljs-doctag">@throws</span> Exception
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptMD5(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception {

        MessageDigest md5 = MessageDigest.getInstance(KEY_MD5);
        md5.update(data);

        <span class="hljs-keyword">return</span> md5.digest();
    }
</code></pre>
<p>&#x901A;&#x5E38;&#x6211;&#x4EEC;&#x4E0D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;MD5&#x52A0;&#x5BC6;&#x3002;&#x901A;&#x5E38;&#x5C06;MD5&#x4EA7;&#x751F;&#x7684;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x4EA4;&#x7ED9;BASE64&#x518D;&#x52A0;&#x5BC6;&#x4E00;&#x628A;&#xFF0C;&#x5F97;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; </p>
<h2 id="13-sha"><a name="13-sha" class="anchor-navigation-ex-anchor" href="#13-sha"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. SHA</h2>
<p>SHA(Secure Hash Algorithm&#xFF0C;&#x5B89;&#x5168;&#x6563;&#x5217;&#x7B97;&#x6CD5;&#xFF09;&#xFF0C;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x7B49;&#x5BC6;&#x7801;&#x5B66;&#x5E94;&#x7528;&#x4E2D;&#x91CD;&#x8981;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x88AB;&#x5E7F;&#x6CDB;&#x5730;&#x5E94;&#x7528;&#x4E8E;&#x7535;&#x5B50;&#x5546;&#x52A1;&#x7B49;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x9886;&#x57DF;&#x3002;&#x867D;&#x7136;&#xFF0C;SHA&#x4E0E;MD5&#x901A;&#x8FC7;&#x78B0;&#x649E;&#x6CD5;&#x90FD;&#x88AB;&#x7834;&#x89E3;&#x4E86;&#xFF0C; &#x4F46;&#x662F;SHA&#x4ECD;&#x7136;&#x662F;&#x516C;&#x8BA4;&#x7684;&#x5B89;&#x5168;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x8F83;&#x4E4B;MD5&#x66F4;&#x4E3A;&#x5B89;&#x5168;&#x3002; </p>
<p><img src="images/003-sha.jpg" alt=""></p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-java">    <span class="hljs-comment">/**
     * SHA&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptSHA(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception {

        MessageDigest sha = MessageDigest.getInstance(KEY_SHA);
        sha.update(data);

        <span class="hljs-keyword">return</span> sha.digest();

    }
}
</code></pre>
<h2 id="14-hmac"><a name="14-hmac" class="anchor-navigation-ex-anchor" href="#14-hmac"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. HMAC</h2>
<p>HMAC(Hash Message Authentication Code&#xFF0C;&#x6563;&#x5217;&#x6D88;&#x606F;&#x9274;&#x522B;&#x7801;&#xFF0C;&#x57FA;&#x4E8E;&#x5BC6;&#x94A5;&#x7684;Hash&#x7B97;&#x6CD5;&#x7684;&#x8BA4;&#x8BC1;&#x534F;&#x8BAE;&#x3002;&#x6D88;&#x606F;&#x9274;&#x522B;&#x7801;&#x5B9E;&#x73B0;&#x9274;&#x522B;&#x7684;&#x539F;&#x7406;&#x662F;&#xFF0C;&#x7528;&#x516C;&#x5F00;&#x51FD;&#x6570;&#x548C;&#x5BC6;&#x94A5;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x8BA4;&#x8BC1;&#x6807;&#x8BC6;&#xFF0C;&#x7528;&#x8FD9;&#x4E2A;&#x6807;&#x8BC6;&#x9274;&#x522B;&#x6D88;&#x606F;&#x7684;&#x5B8C;&#x6574;&#x6027;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x5C0F;&#x6570;&#x636E;&#x5757;&#xFF0C;&#x5373;MAC&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x52A0;&#x5165;&#x5230;&#x6D88;&#x606F;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x4F20;&#x8F93;&#x3002;&#x63A5;&#x6536;&#x65B9;&#x5229;&#x7528;&#x4E0E;&#x53D1;&#x9001;&#x65B9;&#x5171;&#x4EAB;&#x7684;&#x5BC6;&#x94A5;&#x8FDB;&#x884C;&#x9274;&#x522B;&#x8BA4;&#x8BC1;&#x7B49;&#x3002; </p>
<p><img src="images/004-hmac.jpg" alt="004-hmac.jpg"></p>
<pre><code class="lang-java">    <span class="hljs-comment">/**
    * &#x521D;&#x59CB;&#x5316;HMAC&#x5BC6;&#x94A5;
    * 
    * <span class="hljs-doctag">@return</span>
    * <span class="hljs-doctag">@throws</span> Exception
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">initMacKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyGenerator keyGenerator = KeyGenerator.getInstance(KEY_MAC);

        SecretKey secretKey = keyGenerator.generateKey();
        <span class="hljs-keyword">return</span> encryptBASE64(secretKey.getEncoded());
    }

    <span class="hljs-comment">/**
    * HMAC&#x52A0;&#x5BC6;
    * 
    * <span class="hljs-doctag">@param</span> data
    * <span class="hljs-doctag">@param</span> key
    * <span class="hljs-doctag">@return</span>
    * <span class="hljs-doctag">@throws</span> Exception
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptHMAC(<span class="hljs-keyword">byte</span>[] data, String key) <span class="hljs-keyword">throws</span> Exception {

        SecretKey secretKey = <span class="hljs-keyword">new</span> SecretKeySpec(decryptBASE64(key), KEY_MAC);
        Mac mac = Mac.getInstance(secretKey.getAlgorithm());
        mac.init(secretKey);

        <span class="hljs-keyword">return</span> mac.doFinal(data);

    }
</code></pre>
<p>&#x5B8C;&#x6574;&#x7C7B;&#x4EE3;&#x7801;</p>
<pre><code class="lang-java"><span class="hljs-comment">// runs on jdk1.8</span>

<span class="hljs-keyword">import</span> java.security.MessageDigest;

<span class="hljs-keyword">import</span> javax.crypto.KeyGenerator;
<span class="hljs-keyword">import</span> javax.crypto.Mac;
<span class="hljs-keyword">import</span> javax.crypto.SecretKey;
<span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;

<span class="hljs-keyword">import</span> java.util.Base64;

<span class="hljs-comment">/**
 * &#x57FA;&#x7840;&#x52A0;&#x5BC6;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Coder</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_SHA = <span class="hljs-string">&quot;SHA&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_MD5 = <span class="hljs-string">&quot;MD5&quot;</span>;

    <span class="hljs-comment">/**
     * MAC&#x7B97;&#x6CD5;&#x53EF;&#x9009;&#x4EE5;&#x4E0B;&#x591A;&#x79CD;&#x7B97;&#x6CD5;
     * 
     * &lt;pre&gt;
     * HmacMD5 
     * HmacSHA1 
     * HmacSHA256 
     * HmacSHA384 
     * HmacSHA512
     * &lt;/pre&gt;
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_MAC = <span class="hljs-string">&quot;HmacMD5&quot;</span>;

    <span class="hljs-comment">/**
     * BASE64&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptBASE64(String key) <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-keyword">return</span> Base64.getDecoder().decode(key);
    }

    <span class="hljs-comment">/**
     * BASE64&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">encryptBASE64</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] key)</span> <span class="hljs-keyword">throws</span> Exception </span>{
         <span class="hljs-keyword">return</span> Base64.getEncoder().encodeToString(key);
    }

    <span class="hljs-comment">/**
     * MD5&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptMD5(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception {

        MessageDigest md5 = MessageDigest.getInstance(KEY_MD5);
        md5.update(data);

        <span class="hljs-keyword">return</span> md5.digest();

    }

    <span class="hljs-comment">/**
     * SHA&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptSHA(<span class="hljs-keyword">byte</span>[] data) <span class="hljs-keyword">throws</span> Exception {

        MessageDigest sha = MessageDigest.getInstance(KEY_SHA);
        sha.update(data);

        <span class="hljs-keyword">return</span> sha.digest();

    }

    <span class="hljs-comment">/**
     * &#x521D;&#x59CB;&#x5316;HMAC&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">initMacKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyGenerator keyGenerator = KeyGenerator.getInstance(KEY_MAC);

        SecretKey secretKey = keyGenerator.generateKey();
        <span class="hljs-keyword">return</span> encryptBASE64(secretKey.getEncoded());
    }

    <span class="hljs-comment">/**
     * HMAC&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptHMAC(<span class="hljs-keyword">byte</span>[] data, String key) <span class="hljs-keyword">throws</span> Exception {

        SecretKey secretKey = <span class="hljs-keyword">new</span> SecretKeySpec(decryptBASE64(key), KEY_MAC);
        Mac mac = Mac.getInstance(secretKey.getAlgorithm());
        mac.init(secretKey);

        <span class="hljs-keyword">return</span> mac.doFinal(data);

    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-comment">// runs on jdk1.8</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;
<span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        String inputStr = <span class="hljs-string">&quot;&#x7B80;&#x5355;&#x52A0;&#x5BC6;&quot;</span>;
        System.err.println(<span class="hljs-string">&quot;&#x539F;&#x6587;:\n&quot;</span> + inputStr);

        <span class="hljs-keyword">byte</span>[] inputData = inputStr.getBytes();
        String code = Coder.encryptBASE64(inputData);

        System.err.println(<span class="hljs-string">&quot;BASE64&#x52A0;&#x5BC6;&#x540E;:\n&quot;</span> + code);

        <span class="hljs-keyword">byte</span>[] output = Coder.decryptBASE64(code);

        String outputStr = <span class="hljs-keyword">new</span> String(output);

        System.err.println(<span class="hljs-string">&quot;BASE64&#x89E3;&#x5BC6;&#x540E;:\n&quot;</span> + outputStr);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;BASE64&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x4E00;&#x81F4;&#x6027;</span>
        assertEquals(inputStr, outputStr);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;MD5&#x5BF9;&#x4E8E;&#x540C;&#x4E00;&#x5185;&#x5BB9;&#x52A0;&#x5BC6;&#x662F;&#x5426;&#x4E00;&#x81F4;</span>
        assertArrayEquals(Coder.encryptMD5(inputData), Coder
                .encryptMD5(inputData));

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;SHA&#x5BF9;&#x4E8E;&#x540C;&#x4E00;&#x5185;&#x5BB9;&#x52A0;&#x5BC6;&#x662F;&#x5426;&#x4E00;&#x81F4;</span>
        assertArrayEquals(Coder.encryptSHA(inputData), Coder
                .encryptSHA(inputData));

        String key = Coder.initMacKey();
        System.err.println(<span class="hljs-string">&quot;Mac&#x5BC6;&#x94A5;:\n&quot;</span> + key);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;HMAC&#x5BF9;&#x4E8E;&#x540C;&#x4E00;&#x5185;&#x5BB9;&#xFF0C;&#x540C;&#x4E00;&#x5BC6;&#x94A5;&#x52A0;&#x5BC6;&#x662F;&#x5426;&#x4E00;&#x81F4;</span>
        assertArrayEquals(Coder.encryptHMAC(inputData, key), Coder.encryptHMAC(
                inputData, key));

        BigInteger md5 = <span class="hljs-keyword">new</span> BigInteger(Coder.encryptMD5(inputData));
        System.err.println(<span class="hljs-string">&quot;MD5:\n&quot;</span> + md5.toString(<span class="hljs-number">16</span>));

        BigInteger sha = <span class="hljs-keyword">new</span> BigInteger(Coder.encryptSHA(inputData));
        System.err.println(<span class="hljs-string">&quot;SHA:\n&quot;</span> + sha.toString(<span class="hljs-number">32</span>));

        BigInteger mac = <span class="hljs-keyword">new</span> BigInteger(Coder.encryptHMAC(inputData, inputStr));
        System.err.println(<span class="hljs-string">&quot;HMAC:\n&quot;</span> + mac.toString(<span class="hljs-number">16</span>));
    }
}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x539F;&#x6587;:
&#x7B80;&#x5355;&#x52A0;&#x5BC6;
BASE64&#x52A0;&#x5BC6;&#x540E;:
566A5Y2V5Yqg5a+G

BASE64&#x89E3;&#x5BC6;&#x540E;:
&#x7B80;&#x5355;&#x52A0;&#x5BC6;
Mac&#x5BC6;&#x94A5;:
uGxdHC+6ylRDaik++leFtGwiMbuYUJ6mqHWyhSgF4trVkVBBSQvY/a22xU8XT1RUemdCWW155Bke
pBIpkd7QHg==

MD5:
-550b4d90349ad4629462113e7934de56
SHA:
91k9vo7p400cjkgfhjh0ia9qthsjagfn
HMAC:
2287d192387e95694bdbba2fa941009a
</code></pre><p>&#x6CE8;&#x610F; 
&#x7F16;&#x8BD1;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x63D0;&#x793A;&#xFF1A; </p>
<pre><code>&#x5F15;&#x7528;

&#x8B66;&#x544A;&#xFF1A;sun.misc.BASE64Decoder &#x662F; Sun &#x7684;&#x4E13;&#x7528; API&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x672A;&#x6765;&#x7248;&#x672C;&#x4E2D;&#x5220;&#x9664; 

import sun.misc.BASE64Decoder; 
            ^ 
&#x8B66;&#x544A;&#xFF1A;sun.misc.BASE64Encoder &#x662F; Sun &#x7684;&#x4E13;&#x7528; API&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x672A;&#x6765;&#x7248;&#x672C;&#x4E2D;&#x5220;&#x9664; 

import sun.misc.BASE64Encoder; 
</code></pre><p><strong><span stype="color:red">BASE64Encoder &#x548C;BASE64Decoder&#x662F;&#x975E;&#x5B98;&#x65B9;JDK&#x5B9E;&#x73B0;&#x7C7B;&#x3002;&#x867D;&#x7136;&#x53EF;&#x4EE5;&#x5728;JDK&#x91CC;&#x80FD;&#x627E;&#x5230;&#x5E76;&#x4F7F;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x5728;API&#x91CC;&#x67E5;&#x4E0D;&#x5230;&#x3002;JRE &#x4E2D; sun &#x548C; com.sun &#x5F00;&#x5934;&#x5305;&#x7684;&#x7C7B;&#x90FD;&#x662F;&#x672A;&#x88AB;&#x6587;&#x6863;&#x5316;&#x7684;&#xFF0C;&#x4ED6;&#x4EEC;&#x5C5E;&#x4E8E; java, javax &#x7C7B;&#x5E93;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x5B9E;&#x73B0;&#x5927;&#x591A;&#x6570;&#x4E0E;&#x5E95;&#x5C42;&#x5E73;&#x53F0;&#x6709;&#x5173;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x662F;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7684;&#x3002; </span></strong></p>
<p>BASE64&#x7684;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x662F;&#x53CC;&#x5411;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x6C42;&#x53CD;&#x89E3;&#x3002; </p>
<p>MD5&#x3001;SHA&#x4EE5;&#x53CA;HMAC&#x662F;&#x5355;&#x5411;&#x52A0;&#x5BC6;&#xFF0C;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x540E;&#x53EA;&#x4F1A;&#x4EA7;&#x751F;&#x552F;&#x4E00;&#x7684;&#x4E00;&#x4E2A;&#x52A0;&#x5BC6;&#x4E32;&#xFF0C;&#x901A;&#x5E38;&#x7528;&#x6765;&#x6821;&#x9A8C;&#x6570;&#x636E;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x662F;&#x5426;&#x88AB;&#x4FEE;&#x6539;&#x3002;&#x5176;&#x4E2D;HMAC&#x7B97;&#x6CD5;&#x6709;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#xFF0C;&#x589E;&#x5F3A;&#x4E86;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x5B89;&#x5168;&#x6027;&#xFF0C;&#x5F3A;&#x5316;&#x4E86;&#x7B97;&#x6CD5;&#x5916;&#x7684;&#x4E0D;&#x53EF;&#x63A7;&#x56E0;&#x7D20;&#x3002; </p>
<p>&#x5355;&#x5411;&#x52A0;&#x5BC6;&#x7684;&#x7528;&#x9014;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x6821;&#x9A8C;&#x6570;&#x636E;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x662F;&#x5426;&#x88AB;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x6700;&#x5E38;&#x7528;&#x7684;&#x83AB;&#x8FC7;&#x4E8E;DES&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;</p>
<h2 id="15-des"><a name="15-des" class="anchor-navigation-ex-anchor" href="#15-des"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. DES</h2>
<p>DES-Data Encryption Standard,&#x5373;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;&#x662F;IBM&#x516C;&#x53F8;&#x4E8E;1975&#x5E74;&#x7814;&#x7A76;&#x6210;&#x529F;&#x5E76;&#x516C;&#x5F00;&#x53D1;&#x8868;&#x7684;&#x3002;</p>
<p>DES&#x7B97;&#x6CD5;&#x7684;&#x5165;&#x53E3;&#x53C2;&#x6570;&#x6709;&#x4E09;&#x4E2A;:Key&#x3001;Data&#x3001;Mode&#x3002;&#x5176;&#x4E2D; Key&#x4E3A;8&#x4E2A;&#x5B57;&#x8282;&#x5171;64&#x4F4D;,&#x662F;DES&#x7B97;&#x6CD5;&#x7684;&#x5DE5;&#x4F5C;&#x5BC6;&#x94A5;;Data&#x4E5F;&#x4E3A;8&#x4E2A;&#x5B57;&#x8282;64&#x4F4D;,&#x662F;&#x8981;&#x88AB;&#x52A0;&#x5BC6;&#x6216;&#x88AB;&#x89E3;&#x5BC6;&#x7684;&#x6570;&#x636E;;Mode&#x4E3A;DES&#x7684;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;,&#x6709;&#x4E24;&#x79CD;:&#x52A0;&#x5BC6;&#x6216;&#x89E3;&#x5BC6;&#x3002; </p>
<p>DES&#x7B97;&#x6CD5;&#x628A;64&#x4F4D;&#x7684;&#x660E;&#x6587;&#x8F93;&#x5165;&#x5757;&#x53D8;&#x4E3A;64&#x4F4D;&#x7684;&#x5BC6;&#x6587;&#x8F93;&#x51FA;&#x5757;,&#x5B83;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x5BC6;&#x94A5;&#x4E5F;&#x662F;64&#x4F4D;&#x3002; </p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.security.SecureRandom;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;
<span class="hljs-keyword">import</span> javax.crypto.KeyGenerator;
<span class="hljs-keyword">import</span> javax.crypto.SecretKey;
<span class="hljs-keyword">import</span> javax.crypto.SecretKeyFactory;
<span class="hljs-keyword">import</span> javax.crypto.spec.DESKeySpec;


<span class="hljs-comment">/**
 * DES&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * &lt;pre&gt;
 * &#x652F;&#x6301; DES&#x3001;DESede(TripleDES,&#x5C31;&#x662F;3DES)&#x3001;AES&#x3001;Blowfish&#x3001;RC2&#x3001;RC4(ARCFOUR)
 * DES                  key size must be equal to 56
 * DESede(TripleDES)     key size must be equal to 112 or 168
 * AES                  key size must be equal to 128, 192 or 256,but 192 and 256 bits may not be available
 * Blowfish             key size must be multiple of 8, and can only range from 32 to 448 (inclusive)
 * RC2                  key size must be between 40 and 1024 bits
 * RC4(ARCFOUR)         key size must be between 40 and 1024 bits
 * &#x5177;&#x4F53;&#x5185;&#x5BB9; &#x9700;&#x8981;&#x5173;&#x6CE8; JDK Document http://.../docs/technotes/guides/security/SunProviders.html
 * &lt;/pre&gt;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DESCoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{
    <span class="hljs-comment">/**
     * ALGORITHM &#x7B97;&#x6CD5; &lt;br&gt;
     * &#x53EF;&#x66FF;&#x6362;&#x4E3A;&#x4EE5;&#x4E0B;&#x4EFB;&#x610F;&#x4E00;&#x79CD;&#x7B97;&#x6CD5;&#xFF0C;&#x540C;&#x65F6;key&#x503C;&#x7684;size&#x76F8;&#x5E94;&#x6539;&#x53D8;&#x3002;
     * 
     * &lt;pre&gt;
     * DES                  key size must be equal to 56
     * DESede(TripleDES)     key size must be equal to 112 or 168
     * AES                  key size must be equal to 128, 192 or 256,but 192 and 256 bits may not be available
     * Blowfish             key size must be multiple of 8, and can only range from 32 to 448 (inclusive)
     * RC2                  key size must be between 40 and 1024 bits
     * RC4(ARCFOUR)         key size must be between 40 and 1024 bits
     * &lt;/pre&gt;
     * 
     * &#x5728;Key toKey(byte[] key)&#x65B9;&#x6CD5;&#x4E2D;&#x4F7F;&#x7528;&#x4E0B;&#x8FF0;&#x4EE3;&#x7801;
     * &lt;code&gt;SecretKey secretKey = new SecretKeySpec(key, ALGORITHM);&lt;/code&gt; &#x66FF;&#x6362;
     * &lt;code&gt;
     * DESKeySpec dks = new DESKeySpec(key);
     * SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
     * SecretKey secretKey = keyFactory.generateSecret(dks);
     * &lt;/code&gt;
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ALGORITHM = <span class="hljs-string">&quot;DES&quot;</span>;

    <span class="hljs-comment">/**
     * &#x8F6C;&#x6362;&#x5BC6;&#x94A5;&lt;br&gt;
     * 
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Key <span class="hljs-title">toKey</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] key)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        DESKeySpec dks = <span class="hljs-keyword">new</span> DESKeySpec(key);
        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
        SecretKey secretKey = keyFactory.generateSecret(dks);

        <span class="hljs-comment">// &#x5F53;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x65F6;&#xFF0C;&#x5982;AES&#x3001;Blowfish&#x7B49;&#x7B97;&#x6CD5;&#x65F6;&#xFF0C;&#x7528;&#x4E0B;&#x8FF0;&#x4EE3;&#x7801;&#x66FF;&#x6362;&#x4E0A;&#x8FF0;&#x4E09;&#x884C;&#x4EE3;&#x7801;</span>
        <span class="hljs-comment">// SecretKey secretKey = new SecretKeySpec(key, ALGORITHM);</span>

        <span class="hljs-keyword">return</span> secretKey;
    }

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decrypt(<span class="hljs-keyword">byte</span>[] data, String key) <span class="hljs-keyword">throws</span> Exception {
        Key k = toKey(decryptBASE64(key));

        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.DECRYPT_MODE, k);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encrypt(<span class="hljs-keyword">byte</span>[] data, String key) <span class="hljs-keyword">throws</span> Exception {
        Key k = toKey(decryptBASE64(key));
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.ENCRYPT_MODE, k);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x751F;&#x6210;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">initKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-keyword">return</span> initKey(<span class="hljs-keyword">null</span>);
    }

    <span class="hljs-comment">/**
     * &#x751F;&#x6210;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> seed
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">initKey</span><span class="hljs-params">(String seed)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        SecureRandom secureRandom = <span class="hljs-keyword">null</span>;

        <span class="hljs-keyword">if</span> (seed != <span class="hljs-keyword">null</span>) {
            secureRandom = <span class="hljs-keyword">new</span> SecureRandom(decryptBASE64(seed));
        } <span class="hljs-keyword">else</span> {
            secureRandom = <span class="hljs-keyword">new</span> SecureRandom();
        }

        KeyGenerator kg = KeyGenerator.getInstance(ALGORITHM);
        kg.init(secureRandom);

        SecretKey secretKey = kg.generateKey();

        <span class="hljs-keyword">return</span> encryptBASE64(secretKey.getEncoded());
    }
}
</code></pre>
<p>&#x5EF6;&#x7EED;&#x4E0A;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;MD5&#x4EE5;&#x53CA;SHA&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x5BC6;&#x751F;&#x6210;&#x5BC6;&#x94A5;&#xFF0C;&#x8FD9;&#x662F;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x5BC6;&#x94A5;&#x751F;&#x6210;&#x65B9;&#x5F0F;&#x3002; </p>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;


<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DESCoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        String inputStr = <span class="hljs-string">&quot;DES&quot;</span>;
        String key = DESCoder.initKey();
        System.err.println(<span class="hljs-string">&quot;&#x539F;&#x6587;:\t&quot;</span> + inputStr);

        System.err.println(<span class="hljs-string">&quot;&#x5BC6;&#x94A5;:\t&quot;</span> + key);

        <span class="hljs-keyword">byte</span>[] inputData = inputStr.getBytes();
        inputData = DESCoder.encrypt(inputData, key);

        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x540E;:\t&quot;</span> + DESCoder.encryptBASE64(inputData));

        <span class="hljs-keyword">byte</span>[] outputData = DESCoder.decrypt(inputData, key);
        String outputStr = <span class="hljs-keyword">new</span> String(outputData);

        System.err.println(<span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;:\t&quot;</span> + outputStr);

        assertEquals(inputStr, outputStr);
    }
}
</code></pre>
<p>&#x5F97;&#x5230;&#x7684;&#x8F93;&#x51FA;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>&#x539F;&#x6587;:    DES
&#x5BC6;&#x94A5;:    f3wEtRrV6q0=

&#x52A0;&#x5BC6;&#x540E;:    C6qe9oNIzRY=

&#x89E3;&#x5BC6;&#x540E;:    DES
</code></pre><p>&#x7531;&#x63A7;&#x5236;&#x53F0;&#x5F97;&#x5230;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x6BD4;&#x5BF9;&#x52A0;&#x5BC6;&#x3001;&#x89E3;&#x5BC6;&#x540E;&#x7ED3;&#x679C;&#x4E00;&#x81F4;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x65B9;&#x5F0F;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#x3002; </p>
<p>&#x5176;&#x5B9E;DES&#x6709;&#x5F88;&#x591A;&#x540C;&#x80DE;&#x5144;&#x5F1F;&#xFF0C;&#x5982;DESede(TripleDES)&#x3001;AES&#x3001;Blowfish&#x3001;RC2&#x3001;RC4(ARCFOUR)&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x8FC7;&#x591A;&#x9610;&#x8FF0;&#x4E86;&#xFF0C;&#x5927;&#x540C;&#x5C0F;&#x5F02;&#xFF0C;&#x53EA;&#x8981;&#x6362;&#x6389;ALGORITHM&#x6362;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#xFF0C;&#x540C;&#x65F6;&#x505A;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x66FF;&#x6362;
<code>SecretKey secretKey = new SecretKeySpec(key, ALGORITHM);</code>
&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x6B64;&#x5916;&#x5C31;&#x662F;&#x5BC6;&#x94A5;&#x957F;&#x5EA6;&#x4E0D;&#x540C;&#x4E86;&#x3002;</p>
<pre><code class="lang-java"><span class="hljs-comment">/**
 * DES          key size must be equal to 56
 * DESede(TripleDES) key size must be equal to 112 or 168
 * AES          key size must be equal to 128, 192 or 256,but 192 and 256 bits may not be available
 * Blowfish     key size must be multiple of 8, and can only range from 32 to 448 (inclusive)
 * RC2          key size must be between 40 and 1024 bits
 * RC4(ARCFOUR) key size must be between 40 and 1024 bits
 **/</span>
</code></pre>
<p>&#x9664;&#x4E86;DES&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x77E5;&#x9053;&#x6709;DESede(TripleDES,&#x5C31;&#x662F;3DES)&#x3001;AES&#x3001;Blowfish&#x3001;RC2&#x3001;RC4(ARCFOUR)&#x7B49;&#x591A;&#x79CD;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#xFF0C;&#x5176;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x5927;&#x540C;&#x5C0F;&#x5F02;&#xFF0C;&#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x2014;&#x2014;PBE </p>
<h2 id="16-pbe"><a name="16-pbe" class="anchor-navigation-ex-anchor" href="#16-pbe"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. PBE</h2>
<p>PBE&#x2014;&#x2014;Password-based encryption&#xFF08;&#x57FA;&#x4E8E;&#x5BC6;&#x7801;&#x52A0;&#x5BC6;&#xFF09;&#x3002;</p>
<p>&#x5176;&#x7279;&#x70B9;&#x5728;&#x4E8E;&#x53E3;&#x4EE4;&#x7531;&#x7528;&#x6237;&#x81EA;&#x5DF1;&#x638C;&#x7BA1;&#xFF0C;&#x4E0D;&#x501F;&#x52A9;&#x4EFB;&#x4F55;&#x7269;&#x7406;&#x5A92;&#x4F53;&#xFF1B;&#x91C7;&#x7528;&#x968F;&#x673A;&#x6570;&#xFF08;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EB;&#x505A;&#x76D0;&#xFF09;&#x6742;&#x51D1;&#x591A;&#x91CD;&#x52A0;&#x5BC6;&#x7B49;&#x65B9;&#x6CD5;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x5B89;&#x5168;&#x6027;&#x3002;&#x662F;&#x4E00;&#x79CD;&#x7B80;&#x4FBF;&#x7684;&#x52A0;&#x5BC6;&#x65B9;&#x5F0F;&#x3002; </p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1; </p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.util.Random;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;
<span class="hljs-keyword">import</span> javax.crypto.SecretKey;
<span class="hljs-keyword">import</span> javax.crypto.SecretKeyFactory;
<span class="hljs-keyword">import</span> javax.crypto.spec.PBEKeySpec;
<span class="hljs-keyword">import</span> javax.crypto.spec.PBEParameterSpec;

<span class="hljs-comment">/**
 * PBE&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PBECoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{
    <span class="hljs-comment">/**
     * &#x652F;&#x6301;&#x4EE5;&#x4E0B;&#x4EFB;&#x610F;&#x4E00;&#x79CD;&#x7B97;&#x6CD5;
     * 
     * &lt;pre&gt;
     * PBEWithMD5AndDES 
     * PBEWithMD5AndTripleDES 
     * PBEWithSHA1AndDESede
     * PBEWithSHA1AndRC2_40
     * &lt;/pre&gt;
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ALGORITHM = <span class="hljs-string">&quot;PBEWITHMD5andDES&quot;</span>;

    <span class="hljs-comment">/**
     * &#x76D0;&#x521D;&#x59CB;&#x5316;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] initSalt() <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">byte</span>[] salt = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">8</span>];
        Random random = <span class="hljs-keyword">new</span> Random();
        random.nextBytes(salt);
        <span class="hljs-keyword">return</span> salt;
    }

    <span class="hljs-comment">/**
     * &#x8F6C;&#x6362;&#x5BC6;&#x94A5;&lt;br&gt;
     * 
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Key <span class="hljs-title">toKey</span><span class="hljs-params">(String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        PBEKeySpec keySpec = <span class="hljs-keyword">new</span> PBEKeySpec(password.toCharArray());
        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);
        SecretKey secretKey = keyFactory.generateSecret(keySpec);

        <span class="hljs-keyword">return</span> secretKey;
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data &#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> password &#x5BC6;&#x7801;
     * <span class="hljs-doctag">@param</span> salt  &#x76D0;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encrypt(<span class="hljs-keyword">byte</span>[] data, String password, <span class="hljs-keyword">byte</span>[] salt)
            <span class="hljs-keyword">throws</span> Exception {

        Key key = toKey(password);

        PBEParameterSpec paramSpec = <span class="hljs-keyword">new</span> PBEParameterSpec(salt, <span class="hljs-number">100</span>);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.ENCRYPT_MODE, key, paramSpec);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data  &#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> password &#x5BC6;&#x7801;
     * <span class="hljs-doctag">@param</span> salt  &#x76D0;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decrypt(<span class="hljs-keyword">byte</span>[] data, String password, <span class="hljs-keyword">byte</span>[] salt)
            <span class="hljs-keyword">throws</span> Exception {

        Key key = toKey(password);

        PBEParameterSpec paramSpec = <span class="hljs-keyword">new</span> PBEParameterSpec(salt, <span class="hljs-number">100</span>);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.DECRYPT_MODE, key, paramSpec);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A; </p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PBECoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        String inputStr = <span class="hljs-string">&quot;abc&quot;</span>;
        System.err.println(<span class="hljs-string">&quot;&#x539F;&#x6587;: &quot;</span> + inputStr);
        <span class="hljs-keyword">byte</span>[] input = inputStr.getBytes();

        String pwd = <span class="hljs-string">&quot;efg&quot;</span>;
        System.err.println(<span class="hljs-string">&quot;&#x5BC6;&#x7801;: &quot;</span> + pwd);

        <span class="hljs-keyword">byte</span>[] salt = PBECoder.initSalt();

        <span class="hljs-keyword">byte</span>[] data = PBECoder.encrypt(input, pwd, salt);

        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x540E;: &quot;</span> + PBECoder.encryptBASE64(data));

        <span class="hljs-keyword">byte</span>[] output = PBECoder.decrypt(data, pwd, salt);
        String outputStr = <span class="hljs-keyword">new</span> String(output);

        System.err.println(<span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);
    }

}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A; </p>
<pre><code>&#x539F;&#x6587;: abc
&#x5BC6;&#x7801;: efg
&#x52A0;&#x5BC6;&#x540E;: iCZ0uRtaAhE=

&#x89E3;&#x5BC6;&#x540E;: abc
</code></pre><p>&#x540E;&#x7EED;&#x4ECB;&#x7ECD;&#x975E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x5982;RSA&#x3001;DSA&#x3001;DH&#x3001;ECC&#x7B49;&#x3002; </p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x5178;&#x578B;&#x7684;&#x975E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x2014;&#x2014;RSA </p>
<h2 id="17-rsa"><a name="17-rsa" class="anchor-navigation-ex-anchor" href="#17-rsa"><i class="fa fa-link" aria-hidden="true"></i></a>1.7. RSA</h2>
<p>&#x8FD9;&#x79CD;&#x7B97;&#x6CD5;1978&#x5E74;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#xFF0C;&#x5B83;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x65E2;&#x80FD;&#x7528;&#x4E8E;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x4E5F;&#x80FD;&#x7528;&#x4E8E;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x7684;&#x7B97;&#x6CD5;&#x3002;&#x5B83;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#x548C;&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x5F88;&#x6D41;&#x884C;&#x3002;&#x7B97;&#x6CD5;&#x7684;&#x540D;&#x5B57;&#x4EE5;&#x53D1;&#x660E;&#x8005;&#x7684;&#x540D;&#x5B57;&#x547D;&#x540D;&#xFF1A;Ron Rivest, AdiShamir &#x548C;Leonard Adleman&#x3002; </p>
<p>&#x8FD9;&#x79CD;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x7684;&#x7279;&#x70B9;&#x4E3B;&#x8981;&#x662F;&#x5BC6;&#x94A5;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x4E0A;&#x6587;&#x6211;&#x4EEC;&#x770B;&#x5230;DES&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5BC6;&#x94A5;&#x3002;&#x76F8;&#x5F53;&#x4E8E;&#x53EA;&#x6709;&#x4E00;&#x628A;&#x94A5;&#x5319;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x628A;&#x94A5;&#x5319;&#x4E22;&#x4E86;&#xFF0C;&#x6570;&#x636E;&#x4E5F;&#x5C31;&#x4E0D;&#x5B89;&#x5168;&#x4E86;&#x3002;RSA&#x540C;&#x65F6;&#x6709;&#x4E24;&#x628A;&#x94A5; &#x5319;&#xFF0C;&#x516C;&#x94A5;&#x4E0E;&#x79C1;&#x94A5;&#x3002;&#x540C;&#x65F6;&#x652F;&#x6301;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x3002;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x7684;&#x610F;&#x4E49;&#x5728;&#x4E8E;&#xFF0C;&#x5BF9;&#x4F20;&#x8F93;&#x8FC7;&#x6765;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6821;&#x9A8C;&#x3002;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x5728;&#x4F20;&#x8F93;&#x5DE5;&#x7A0B;&#x4E2D;&#x4E0D;&#x88AB;&#x4FEE;&#x6539;&#x3002; </p>
<p>&#x6D41;&#x7A0B;&#x5206;&#x6790;&#xFF1A; </p>
<ol>
<li>&#x7532;&#x65B9;&#x6784;&#x5EFA;&#x5BC6;&#x94A5;&#x5BF9;&#x513F;&#xFF0C;&#x5C06;&#x516C;&#x94A5;&#x516C;&#x5E03;&#x7ED9;&#x4E59;&#x65B9;&#xFF0C;&#x5C06;&#x79C1;&#x94A5;&#x4FDD;&#x7559;&#x3002;</li>
<li>&#x7532;&#x65B9;&#x4F7F;&#x7528;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x7528;&#x79C1;&#x94A5;&#x5BF9;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#x7B7E;&#x540D;&#xFF0C;&#x53D1;&#x9001;&#x7ED9;&#x4E59;&#x65B9;&#x7B7E;&#x540D;&#x4EE5;&#x53CA;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF1B;&#x4E59;&#x65B9;&#x4F7F;&#x7528;&#x516C;&#x94A5;&#x3001;&#x7B7E;&#x540D;&#x6765;&#x9A8C;&#x8BC1;&#x5F85;&#x89E3;&#x5BC6;&#x6570;&#x636E;&#x662F;&#x5426;&#x6709;&#x6548;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x6548;&#x4F7F;&#x7528;&#x516C;&#x94A5;&#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;&#x3002;</li>
<li>&#x4E59;&#x65B9;&#x4F7F;&#x7528;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x5411;&#x7532;&#x65B9;&#x53D1;&#x9001;&#x7ECF;&#x8FC7;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF1B;&#x7532;&#x65B9;&#x83B7;&#x5F97;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x901A;&#x8FC7;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&#x3002;</li>
</ol>
<p>&#x6309;&#x5982;&#x4E0A;&#x6B65;&#x9AA4;&#x7ED9;&#x51FA;&#x5E8F;&#x5217;&#x56FE;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A; </p>
<ol>
<li><p><img src="images/005-rsa-001.jpg" alt=""></p>
</li>
<li><p><img src="images/005-rsa-002.jpg" alt=""></p>
</li>
<li><p><img src="images/005-rsa-003.jpg" alt=""></p>
</li>
</ol>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.security.KeyFactory;
<span class="hljs-keyword">import</span> java.security.KeyPair;
<span class="hljs-keyword">import</span> java.security.KeyPairGenerator;
<span class="hljs-keyword">import</span> java.security.PrivateKey;
<span class="hljs-keyword">import</span> java.security.PublicKey;
<span class="hljs-keyword">import</span> java.security.Signature;
<span class="hljs-keyword">import</span> java.security.interfaces.RSAPrivateKey;
<span class="hljs-keyword">import</span> java.security.interfaces.RSAPublicKey;
<span class="hljs-keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.X509EncodedKeySpec;

<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;

<span class="hljs-comment">/**
 * RSA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RSACoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_ALGORITHM = <span class="hljs-string">&quot;RSA&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SIGNATURE_ALGORITHM = <span class="hljs-string">&quot;MD5withRSA&quot;</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PUBLIC_KEY = <span class="hljs-string">&quot;RSAPublicKey&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PRIVATE_KEY = <span class="hljs-string">&quot;RSAPrivateKey&quot;</span>;

    <span class="hljs-comment">/**
     * &#x7528;&#x79C1;&#x94A5;&#x5BF9;&#x4FE1;&#x606F;&#x751F;&#x6210;&#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x52A0;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> privateKey
     *            &#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">sign</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String privateKey)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x89E3;&#x5BC6;&#x7531;base64&#x7F16;&#x7801;&#x7684;&#x79C1;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(privateKey);

        <span class="hljs-comment">// &#x6784;&#x9020;PKCS8EncodedKeySpec&#x5BF9;&#x8C61;</span>
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(keyBytes);

        <span class="hljs-comment">// KEY_ALGORITHM &#x6307;&#x5B9A;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</span>
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);

        <span class="hljs-comment">// &#x53D6;&#x79C1;&#x94A5;&#x5319;&#x5BF9;&#x8C61;</span>
        PrivateKey priKey = keyFactory.generatePrivate(pkcs8KeySpec);

        <span class="hljs-comment">// &#x7528;&#x79C1;&#x94A5;&#x5BF9;&#x4FE1;&#x606F;&#x751F;&#x6210;&#x6570;&#x5B57;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);
        signature.initSign(priKey);
        signature.update(data);

        <span class="hljs-keyword">return</span> encryptBASE64(signature.sign());
    }

    <span class="hljs-comment">/**
     * &#x6821;&#x9A8C;&#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x52A0;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> publicKey
     *            &#x516C;&#x94A5;
     * <span class="hljs-doctag">@param</span> sign
     *            &#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@return</span> &#x6821;&#x9A8C;&#x6210;&#x529F;&#x8FD4;&#x56DE;true &#x5931;&#x8D25;&#x8FD4;&#x56DE;false
     * <span class="hljs-doctag">@throws</span> Exception
     * 
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verify</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String publicKey, String sign)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{

        <span class="hljs-comment">// &#x89E3;&#x5BC6;&#x7531;base64&#x7F16;&#x7801;&#x7684;&#x516C;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(publicKey);

        <span class="hljs-comment">// &#x6784;&#x9020;X509EncodedKeySpec&#x5BF9;&#x8C61;</span>
        X509EncodedKeySpec keySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);

        <span class="hljs-comment">// KEY_ALGORITHM &#x6307;&#x5B9A;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</span>
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);

        <span class="hljs-comment">// &#x53D6;&#x516C;&#x94A5;&#x5319;&#x5BF9;&#x8C61;</span>
        PublicKey pubKey = keyFactory.generatePublic(keySpec);

        Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM);
        signature.initVerify(pubKey);
        signature.update(data);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&#x662F;&#x5426;&#x6B63;&#x5E38;</span>
        <span class="hljs-keyword">return</span> signature.verify(decryptBASE64(sign));
    }

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String key)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x5BC6;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        Key privateKey = keyFactory.generatePrivate(pkcs8KeySpec);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String key)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x5BC6;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        Key publicKey = keyFactory.generatePublic(x509KeySpec);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x516C;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String key)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x516C;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        Key publicKey = keyFactory.generatePublic(x509KeySpec);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String key)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x5BC6;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);
        Key privateKey = keyFactory.generatePrivate(pkcs8KeySpec);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PRIVATE_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPublicKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PUBLIC_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x521D;&#x59CB;&#x5316;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyPairGenerator keyPairGen = KeyPairGenerator
                .getInstance(KEY_ALGORITHM);
        keyPairGen.initialize(<span class="hljs-number">1024</span>);

        KeyPair keyPair = keyPairGen.generateKeyPair();

        <span class="hljs-comment">// &#x516C;&#x94A5;</span>
        RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();

        <span class="hljs-comment">// &#x79C1;&#x94A5;</span>
        RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();

        Map&lt;String, Object&gt; keyMap = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;(<span class="hljs-number">2</span>);

        keyMap.put(PUBLIC_KEY, publicKey);
        keyMap.put(PRIVATE_KEY, privateKey);
        <span class="hljs-keyword">return</span> keyMap;
    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> org.junit.Before;
<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RSACoderTest</span> </span>{
    <span class="hljs-keyword">private</span> String publicKey;
    <span class="hljs-keyword">private</span> String privateKey;

    <span class="hljs-meta">@Before</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        Map&lt;String, Object&gt; keyMap = RSACoder.initKey();

        publicKey = RSACoder.getPublicKey(keyMap);
        privateKey = RSACoder.getPrivateKey(keyMap);
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;: \n\r&quot;</span> + publicKey);
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#xFF1A; \n\r&quot;</span> + privateKey);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);
        String inputStr = <span class="hljs-string">&quot;abc&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encodedData = RSACoder.encryptByPublicKey(data, publicKey);

        <span class="hljs-keyword">byte</span>[] decodedData = RSACoder.decryptByPrivateKey(encodedData,
                privateKey);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSign</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);
        String inputStr = <span class="hljs-string">&quot;sign&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encodedData = RSACoder.encryptByPrivateKey(data, privateKey);

        <span class="hljs-keyword">byte</span>[] decodedData = RSACoder
                .decryptByPublicKey(encodedData, publicKey);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);

        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&quot;</span>);
        <span class="hljs-comment">// &#x4EA7;&#x751F;&#x7B7E;&#x540D;</span>
        String sign = RSACoder.sign(encodedData, privateKey);
        System.err.println(<span class="hljs-string">&quot;&#x7B7E;&#x540D;:\r&quot;</span> + sign);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;</span>
        <span class="hljs-keyword">boolean</span> status = RSACoder.verify(encodedData, publicKey, sign);
        System.err.println(<span class="hljs-string">&quot;&#x72B6;&#x6001;:\r&quot;</span> + status);
        assertTrue(status);

    }

}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x516C;&#x94A5;: 

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCYU/+I0+z1aBl5X6DUUOHQ7FZpmBSDbKTtx89J
EcB64jFCkunELT8qiKly7fzEqD03g8ALlu5XvX+bBqHFy7YPJJP0ekE2X3wjUnh2NxlqpH3/B/xm
1ZdSlCwDIkbijhBVDjA/bu5BObhZqQmDwIxlQInL9oVz+o6FbAZCyHBd7wIDAQAB

&#x79C1;&#x94A5;&#xFF1A; 

MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAJhT/4jT7PVoGXlfoNRQ4dDsVmmY
FINspO3Hz0kRwHriMUKS6cQtPyqIqXLt/MSoPTeDwAuW7le9f5sGocXLtg8kk/R6QTZffCNSeHY3
GWqkff8H/GbVl1KULAMiRuKOEFUOMD9u7kE5uFmpCYPAjGVAicv2hXP6joVsBkLIcF3vAgMBAAEC
gYBvZHWoZHmS2EZQqKqeuGr58eobG9hcZzWQoJ4nq/CarBAjw/VovUHE490uK3S9ht4FW7Yzg3LV
/MB06Huifh6qf/X9NQA7SeZRRC8gnCQk6JuDIEVJOud5jU+9tyumJakDKodQ3Jf2zQtNr+5ZdEPl
uwWgv9c4kmpjhAdyMuQmYQJBANn6pcgvyYaia52dnu+yBUsGkaFfwXkzFSExIbi0MXTkhEb/ER/D
rLytukkUu5S5ecz/KBa8U4xIslZDYQbLz5ECQQCy5dutt7RsxN4+dxCWn0/1FrkWl2G329Ucewm3
QU9CKu4D+7Kqdj+Ha3lXP8F0Etaaapi7+EfkRUpukn2ItZV/AkEAlk+I0iphxT1rCB0Q5CjWDY5S
Df2B5JmdEG5Y2o0nLXwG2w44OLct/k2uD4cEcuITY5Dvi/4BftMCZwm/dnhEgQJACIktJSnJwxLV
o9dchENPtlsCM9C/Sd2EWpqISSUlmfugZbJBwR5pQ5XeMUqKeXZYpP+HEBj1nS+tMH9u2/IGEwJA
fL8mZiZXan/oBKrblAbplNcKWGRVD/3y65042PAEeghahlJMiYquV5DzZajuuT0wbJ5xQuZB01+X
nfpFpBJ2dw==

&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;
&#x52A0;&#x5BC6;&#x524D;: abc

&#x89E3;&#x5BC6;&#x540E;: abc
&#x516C;&#x94A5;: 

MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDdOj40yEB48XqWxmPILmJAc7UecIN7F32etSHF
9rwbuEh3+iTPOGSxhoSQpOED0vOb0ZIMkBXZSgsxLaBSin2RZ09YKWRjtpCA0kDkiD11gj4tzTiM
l9qq1kwSK7ZkGAgodEn3yIILVmQDuEImHOXFtulvJ71ka07u3LuwUNdB/wIDAQAB

&#x79C1;&#x94A5;&#xFF1A; 

MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAN06PjTIQHjxepbGY8guYkBztR5w
g3sXfZ61IcX2vBu4SHf6JM84ZLGGhJCk4QPS85vRkgyQFdlKCzEtoFKKfZFnT1gpZGO2kIDSQOSI
PXWCPi3NOIyX2qrWTBIrtmQYCCh0SffIggtWZAO4QiYc5cW26W8nvWRrTu7cu7BQ10H/AgMBAAEC
gYEAz2JWBizjI31bqhP4XiP9PuY5F3vqBW4T+L9cFbQiyumKJc58yzTWUAUGKIIn3enXLG7dNqGr
mbJro4JeFIJ3CiVDpXR9+FluIgI4SXm7ioGKF2NOMA9LR5Fu82W+pLfpTN2y2SaLYWEDZyp53BxY
j9gUxaxi1MQs+C1ZgDF2xmECQQDy70bQntbRfysP+ppCtd56YRnES1Tyekw0wryS2tr+ivQJl7JF
gp5rPAOXpgrq36xHDwUspQ0sJ0vj0O7ywxr1AkEA6SAaLhrJJrYucC0jxwAhUYyaPN+aOsWymaRh
9jA/Wc0wp29SbGTh5CcMuGpXm1g0M+FKW3dGiHgS3rVUKim4owJAbnxgapUzAgiiHxxMeDaavnHW
9C2GrtjsO7qtZOTgYI/1uT8itvZW8lJTF+9OW8/qXE76fXl7ai9dFnl5kzMk2QJBALfHz/vCsArt
mkRiwY6zApE4Z6tPl1V33ymSVovvUzHnOdD1SKQdD5t+UV/crb3QVi8ED0t2B0u0ZSPfDT/D7kMC
QDpwdj9k2F5aokLHBHUNJPFDAp7a5QMaT64gv/d48ITJ68Co+v5WzLMpzJBYXK6PAtqIhxbuPEc2
I2k1Afmrwyw=

&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;
&#x52A0;&#x5BC6;&#x524D;: sign

&#x89E3;&#x5BC6;&#x540E;: sign
&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;
&#x7B7E;&#x540D;:
ud1RsIwmSC1pN22I4IXteg1VD2FbiehKUfNxgVSHzvQNIK+d20FCkHCqh9djP3h94iWnIUY0ifU+
mbJkhAl/i5krExOE0hknOnPMcEP+lZV1RbJI2zG2YooSp2XDleqrQk5e/QF2Mx0Zxt8Xsg7ucVpn
i3wwbYWs9wSzIf0UjlM=

&#x72B6;&#x6001;:
true
</code></pre><p>&#x7B80;&#x8981;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x3001;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&#xFF0C;&#x5B8C;&#x6210;&#x4E86;&#x4E59;&#x65B9;&#x5230;&#x7532;&#x65B9;&#x7684;&#x4E00;&#x6B21;&#x6570;&#x636E;&#x4F20;&#x9012;&#xFF0C;&#x901A;&#x8FC7;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x3001;&#x516C;&#x94A5;&#x89E3;&#x5BC6;&#xFF0C;&#x540C;&#x65F6;&#x901A;&#x8FC7;&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x3001;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&#xFF0C;&#x5B8C;&#x6210;&#x4E86;&#x4E00;&#x6B21;&#x7532;&#x65B9;&#x5230;&#x4E59;&#x65B9;&#x7684;&#x6570;&#x636E;&#x4F20;&#x9012;&#x4E0E;&#x9A8C;&#x8BC1;&#xFF0C;&#x4E24;&#x6B21;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5B8C;&#x6210;&#x4E00;&#x6574;&#x5957;&#x7684;&#x6570;&#x636E;&#x4EA4;&#x4E92;&#xFF01; </p>
<p>&#x7C7B;&#x4F3C;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#xFF0C;&#x6570;&#x5B57;&#x4FE1;&#x5C01;&#x662F;&#x8FD9;&#x6837;&#x63CF;&#x8FF0;&#x7684;&#xFF1A; </p>
<p><strong>&#x6570;&#x5B57;&#x4FE1;&#x5C01;</strong></p>
<p>&#x6570;&#x5B57;&#x4FE1;&#x5C01;&#x7528;&#x52A0;&#x5BC6;&#x6280;&#x672F;&#x6765;&#x4FDD;&#x8BC1;&#x53EA;&#x6709;&#x7279;&#x5B9A;&#x7684;&#x6536;&#x4FE1;&#x4EBA;&#x624D;&#x80FD;&#x9605;&#x8BFB;&#x4FE1;&#x7684;&#x5185;&#x5BB9;&#x3002; </p>
<p>&#x6D41;&#x7A0B;&#xFF1A; </p>
<p>&#x4FE1;&#x606F;&#x53D1;&#x9001;&#x65B9;&#x91C7;&#x7528;&#x5BF9;&#x79F0;&#x5BC6;&#x94A5;&#x6765;&#x52A0;&#x5BC6;&#x4FE1;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x7528;&#x63A5;&#x6536;&#x65B9;&#x7684;&#x516C;&#x94A5;&#x6765;&#x52A0;&#x5BC6;&#x6B64;&#x5BF9;&#x79F0;&#x5BC6;&#x94A5;&#xFF08;&#x8FD9;&#x90E8;&#x5206;&#x79F0;&#x4E3A;&#x6570;&#x5B57;&#x4FE1;&#x5C01;&#xFF09;&#xFF0C;&#x518D;&#x5C06;&#x5B83;&#x548C;&#x4FE1;&#x606F;&#x4E00;&#x8D77;&#x53D1;&#x9001;&#x7ED9;&#x63A5;&#x6536;&#x65B9;&#xFF1B;&#x63A5;&#x6536;&#x65B9;&#x5148;&#x7528;&#x76F8;&#x5E94;&#x7684;&#x79C1;&#x94A5;&#x6253;&#x5F00;&#x6570;&#x5B57;&#x4FE1;&#x5C01;&#xFF0C;&#x5F97;&#x5230;&#x5BF9;&#x79F0;&#x5BC6;&#x94A5;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x5BF9;&#x79F0;&#x5BC6;&#x94A5;&#x518D;&#x89E3;&#x5F00;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5206;&#x6790;DH&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF0C;&#x4E00;&#x79CD;&#x9002;&#x57FA;&#x4E8E;&#x5BC6;&#x94A5;&#x4E00;&#x81F4;&#x534F;&#x8BAE;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;</p>
<h2 id="18-dh"><a name="18-dh" class="anchor-navigation-ex-anchor" href="#18-dh"><i class="fa fa-link" aria-hidden="true"></i></a>1.8. DH</h2>
<p>Diffie- Hellman&#x7B97;&#x6CD5;(D-H&#x7B97;&#x6CD5;)&#xFF0C;&#x5BC6;&#x94A5;&#x4E00;&#x81F4;&#x534F;&#x8BAE;&#x3002;</p>
<p>&#x662F;&#x7531;&#x516C;&#x5F00;&#x5BC6;&#x94A5;&#x5BC6;&#x7801;&#x4F53;&#x5236;&#x7684;&#x5960;&#x57FA;&#x4EBA;Diffie&#x548C;Hellman&#x6240;&#x63D0;&#x51FA;&#x7684;&#x4E00;&#x79CD;&#x601D;&#x60F3;&#x3002;&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x5C31;&#x662F;&#x5141;&#x8BB8;&#x4E24;&#x540D;&#x7528;&#x6237;&#x5728;&#x516C;&#x5F00;&#x5A92;&#x4F53;&#x4E0A;&#x4EA4;&#x6362;&#x4FE1;&#x606F;&#x4EE5;&#x751F;&#x6210;&quot;&#x4E00;&#x81F4;&quot;&#x7684;&#x3001;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x7684;&#x5BC6;&#x94A5;&#x3002;</p>
<p>&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x7531;&#x7532;&#x65B9;&#x4EA7;&#x51FA;&#x4E00;&#x5BF9;&#x5BC6;&#x94A5;&#xFF08;&#x516C;&#x94A5;&#x3001;&#x79C1;&#x94A5;&#xFF09;&#xFF0C;&#x4E59;&#x65B9;&#x4F9D;&#x7167;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x4EA7;&#x751F;&#x4E59;&#x65B9;&#x5BC6;&#x94A5;&#x5BF9;&#xFF08;&#x516C;&#x94A5;&#x3001;&#x79C1;&#x94A5;&#xFF09;&#x3002;</p>
<p>&#x4EE5;&#x6B64;&#x4E3A;&#x57FA;&#x7EBF;&#xFF0C;&#x4F5C;&#x4E3A;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x4FDD;&#x5BC6;&#x57FA;&#x7840;&#xFF0C;&#x540C;&#x65F6;&#x53CC;&#x65B9;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x79CD;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6784;&#x5EFA;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#xFF08;SecretKey&#xFF09;&#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#xFF0C;&#x5728;&#x4E92;&#x901A;&#x4E86;&#x672C;&#x5730;&#x5BC6;&#x94A5; &#xFF08;SecretKey&#xFF09;&#x7B97;&#x6CD5;&#x540E;&#xFF0C;&#x7532;&#x4E59;&#x53CC;&#x65B9;&#x516C;&#x5F00;&#x81EA;&#x5DF1;&#x7684;&#x516C;&#x94A5;&#xFF0C;&#x4F7F;&#x7528;&#x5BF9;&#x65B9;&#x7684;&#x516C;&#x94A5;&#x548C;&#x521A;&#x624D;&#x4EA7;&#x751F;&#x7684;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x540C;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5BF9;&#x65B9;&#x7684;&#x516C;&#x94A5;&#x548C;&#x81EA;&#x5DF1;&#x7684;&#x79C1;&#x94A5;&#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;&#x3002;&#x4E0D;&#x5355; &#x5355;&#x662F;&#x7532;&#x4E59;&#x53CC;&#x65B9;&#x4E24;&#x65B9;&#xFF0C;&#x53EF;&#x4EE5;&#x6269;&#x5C55;&#x4E3A;&#x591A;&#x65B9;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x901A;&#x8BAF;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x7F51;&#x7EDC;&#x4EA4;&#x4E92;&#x6570;&#x636E;&#x7684;&#x5B89;&#x5168;&#x901A;&#x8BAF;&#xFF01;&#x8BE5;&#x7B97;&#x6CD5;&#x6E90;&#x4E8E;&#x4E2D;&#x56FD;&#x7684;&#x540C;&#x4F59;&#x5B9A;&#x7406;&#x2014;&#x2014;&#x4E2D;&#x56FD;&#x9980;&#x6570;&#x5B9A;&#x7406;&#x3002; </p>
<p>&#x6D41;&#x7A0B;&#x5206;&#x6790;&#xFF1A; </p>
<ol>
<li>&#x7532;&#x65B9;&#x6784;&#x5EFA;&#x5BC6;&#x94A5;&#x5BF9;&#x513F;&#xFF0C;&#x5C06;&#x516C;&#x94A5;&#x516C;&#x5E03;&#x7ED9;&#x4E59;&#x65B9;&#xFF0C;&#x5C06;&#x79C1;&#x94A5;&#x4FDD;&#x7559;&#xFF1B;&#x53CC;&#x65B9;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF1B;&#x4E59;&#x65B9;&#x901A;&#x8FC7;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x6784;&#x5EFA;&#x5BC6;&#x94A5;&#x5BF9;&#x513F;&#xFF0C;&#x5C06;&#x516C;&#x94A5;&#x516C;&#x5E03;&#x7ED9;&#x7532;&#x65B9;&#xFF0C;&#x5C06;&#x79C1;&#x94A5;&#x4FDD;&#x7559;&#x3002; </li>
<li>&#x7532;&#x65B9;&#x4F7F;&#x7528;&#x79C1;&#x94A5;&#x3001;&#x4E59;&#x65B9;&#x516C;&#x94A5;&#x3001;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6784;&#x5EFA;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x53D1;&#x9001;&#x7ED9;&#x4E59;&#x65B9;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF1B;&#x4E59;&#x65B9;&#x4F7F;&#x7528;&#x79C1;&#x94A5;&#x3001;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x3001;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6784;&#x5EFA;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;&#x3002; </li>
<li><p>&#x4E59;&#x65B9;&#x4F7F;&#x7528;&#x79C1;&#x94A5;&#x3001;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x3001;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6784;&#x5EFA;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#x52A0;&#x5BC6;&#x6570;&#x636E;&#xFF0C;&#x53D1;&#x9001;&#x7ED9;&#x7532;&#x65B9;&#x52A0;&#x5BC6;&#x540E;&#x7684;&#x6570;&#x636E;&#xFF1B;&#x7532;&#x65B9;&#x4F7F;&#x7528;&#x79C1;&#x94A5;&#x3001;&#x4E59;&#x65B9;&#x516C;&#x94A5;&#x3001;&#x7EA6;&#x5B9A;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x6784;&#x5EFA;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;&#x3002; </p>
</li>
<li><p><img src="images/006-dh-001.jpg" alt="006-dh-001.jpg"></p>
</li>
<li><img src="images/006-dh-002.jpg" alt="006-dh-001.jpg"></li>
<li><img src="images/006-dh-003.jpg" alt="006-dh-001.jpg"></li>
</ol>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.security.KeyFactory;
<span class="hljs-keyword">import</span> java.security.KeyPair;
<span class="hljs-keyword">import</span> java.security.KeyPairGenerator;
<span class="hljs-keyword">import</span> java.security.PublicKey;
<span class="hljs-keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.X509EncodedKeySpec;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;
<span class="hljs-keyword">import</span> javax.crypto.KeyAgreement;
<span class="hljs-keyword">import</span> javax.crypto.SecretKey;
<span class="hljs-keyword">import</span> javax.crypto.interfaces.DHPrivateKey;
<span class="hljs-keyword">import</span> javax.crypto.interfaces.DHPublicKey;
<span class="hljs-keyword">import</span> javax.crypto.spec.DHParameterSpec;

<span class="hljs-comment">/**
 * DH&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DHCoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ALGORITHM = <span class="hljs-string">&quot;DH&quot;</span>;

    <span class="hljs-comment">/**
     * &#x9ED8;&#x8BA4;&#x5BC6;&#x94A5;&#x5B57;&#x8282;&#x6570;
     * 
     * &lt;pre&gt;
     * DH
     * Default Keysize 1024  
     * Keysize must be a multiple of 64, ranging from 512 to 1024 (inclusive).
     * &lt;/pre&gt;
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> KEY_SIZE = <span class="hljs-number">1024</span>;

    <span class="hljs-comment">/**
     * DH&#x52A0;&#x5BC6;&#x4E0B;&#x9700;&#x8981;&#x4E00;&#x79CD;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;DES&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SECRET_ALGORITHM = <span class="hljs-string">&quot;DES&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PUBLIC_KEY = <span class="hljs-string">&quot;DHPublicKey&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PRIVATE_KEY = <span class="hljs-string">&quot;DHPrivateKey&quot;</span>;

    <span class="hljs-comment">/**
     * &#x521D;&#x59CB;&#x5316;&#x7532;&#x65B9;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyPairGenerator keyPairGenerator = KeyPairGenerator
                .getInstance(ALGORITHM);
        keyPairGenerator.initialize(KEY_SIZE);

        KeyPair keyPair = keyPairGenerator.generateKeyPair();

        <span class="hljs-comment">// &#x7532;&#x65B9;&#x516C;&#x94A5;</span>
        DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();

        <span class="hljs-comment">// &#x7532;&#x65B9;&#x79C1;&#x94A5;</span>
        DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();

        Map&lt;String, Object&gt; keyMap = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;(<span class="hljs-number">2</span>);

        keyMap.put(PUBLIC_KEY, publicKey);
        keyMap.put(PRIVATE_KEY, privateKey);
        <span class="hljs-keyword">return</span> keyMap;
    }

    <span class="hljs-comment">/**
     * &#x521D;&#x59CB;&#x5316;&#x4E59;&#x65B9;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> key
     *            &#x7532;&#x65B9;&#x516C;&#x94A5;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">(String key)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x89E3;&#x6790;&#x7532;&#x65B9;&#x516C;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);
        X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = KeyFactory.getInstance(ALGORITHM);
        PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);

        <span class="hljs-comment">// &#x7531;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x6784;&#x5EFA;&#x4E59;&#x65B9;&#x5BC6;&#x94A5;</span>
        DHParameterSpec dhParamSpec = ((DHPublicKey) pubKey).getParams();

        KeyPairGenerator keyPairGenerator = KeyPairGenerator
                .getInstance(keyFactory.getAlgorithm());
        keyPairGenerator.initialize(dhParamSpec);

        KeyPair keyPair = keyPairGenerator.generateKeyPair();

        <span class="hljs-comment">// &#x4E59;&#x65B9;&#x516C;&#x94A5;</span>
        DHPublicKey publicKey = (DHPublicKey) keyPair.getPublic();

        <span class="hljs-comment">// &#x4E59;&#x65B9;&#x79C1;&#x94A5;</span>
        DHPrivateKey privateKey = (DHPrivateKey) keyPair.getPrivate();

        Map&lt;String, Object&gt; keyMap = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;(<span class="hljs-number">2</span>);

        keyMap.put(PUBLIC_KEY, publicKey);
        keyMap.put(PRIVATE_KEY, privateKey);

        <span class="hljs-keyword">return</span> keyMap;
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;&lt;br&gt;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x5F85;&#x52A0;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> publicKey
     *            &#x7532;&#x65B9;&#x516C;&#x94A5;
     * <span class="hljs-doctag">@param</span> privateKey
     *            &#x4E59;&#x65B9;&#x79C1;&#x94A5;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encrypt(<span class="hljs-keyword">byte</span>[] data, String publicKey,
            String privateKey) <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">// &#x751F;&#x6210;&#x672C;&#x5730;&#x5BC6;&#x94A5;</span>
        SecretKey secretKey = getSecretKey(publicKey, privateKey);

        <span class="hljs-comment">// &#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(secretKey.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, secretKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;&lt;br&gt;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x5F85;&#x89E3;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> publicKey
     *            &#x4E59;&#x65B9;&#x516C;&#x94A5;
     * <span class="hljs-doctag">@param</span> privateKey
     *            &#x4E59;&#x65B9;&#x79C1;&#x94A5;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decrypt(<span class="hljs-keyword">byte</span>[] data, String publicKey,
            String privateKey) <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">// &#x751F;&#x6210;&#x672C;&#x5730;&#x5BC6;&#x94A5;</span>
        SecretKey secretKey = getSecretKey(publicKey, privateKey);
        <span class="hljs-comment">// &#x6570;&#x636E;&#x89E3;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(secretKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, secretKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x6784;&#x5EFA;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> publicKey
     *            &#x516C;&#x94A5;
     * <span class="hljs-doctag">@param</span> privateKey
     *            &#x79C1;&#x94A5;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SecretKey <span class="hljs-title">getSecretKey</span><span class="hljs-params">(String publicKey, String privateKey)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x516C;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] pubKeyBytes = decryptBASE64(publicKey);

        KeyFactory keyFactory = KeyFactory.getInstance(ALGORITHM);
        X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(pubKeyBytes);
        PublicKey pubKey = keyFactory.generatePublic(x509KeySpec);

        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x79C1;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] priKeyBytes = decryptBASE64(privateKey);

        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(priKeyBytes);
        Key priKey = keyFactory.generatePrivate(pkcs8KeySpec);

        KeyAgreement keyAgree = KeyAgreement.getInstance(keyFactory
                .getAlgorithm());
        keyAgree.init(priKey);
        keyAgree.doPhase(pubKey, <span class="hljs-keyword">true</span>);

        <span class="hljs-comment">// &#x751F;&#x6210;&#x672C;&#x5730;&#x5BC6;&#x94A5;</span>
        SecretKey secretKey = keyAgree.generateSecret(SECRET_ALGORITHM);

        <span class="hljs-keyword">return</span> secretKey;
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PRIVATE_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPublicKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PUBLIC_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DHCoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x751F;&#x6210;&#x7532;&#x65B9;&#x5BC6;&#x94A5;&#x5BF9;&#x513F;</span>
        Map&lt;String, Object&gt; aKeyMap = DHCoder.initKey();
        String aPublicKey = DHCoder.getPublicKey(aKeyMap);
        String aPrivateKey = DHCoder.getPrivateKey(aKeyMap);

        System.err.println(<span class="hljs-string">&quot;&#x7532;&#x65B9;&#x516C;&#x94A5;:\r&quot;</span> + aPublicKey);
        System.err.println(<span class="hljs-string">&quot;&#x7532;&#x65B9;&#x79C1;&#x94A5;:\r&quot;</span> + aPrivateKey);

        <span class="hljs-comment">// &#x7531;&#x7532;&#x65B9;&#x516C;&#x94A5;&#x4EA7;&#x751F;&#x672C;&#x5730;&#x5BC6;&#x94A5;&#x5BF9;&#x513F;</span>
        Map&lt;String, Object&gt; bKeyMap = DHCoder.initKey(aPublicKey);
        String bPublicKey = DHCoder.getPublicKey(bKeyMap);
        String bPrivateKey = DHCoder.getPrivateKey(bKeyMap);

        System.err.println(<span class="hljs-string">&quot;&#x4E59;&#x65B9;&#x516C;&#x94A5;:\r&quot;</span> + bPublicKey);
        System.err.println(<span class="hljs-string">&quot;&#x4E59;&#x65B9;&#x79C1;&#x94A5;:\r&quot;</span> + bPrivateKey);

        String aInput = <span class="hljs-string">&quot;abc &quot;</span>;
        System.err.println(<span class="hljs-string">&quot;&#x539F;&#x6587;: &quot;</span> + aInput);

        <span class="hljs-comment">// &#x7531;&#x7532;&#x65B9;&#x516C;&#x94A5;&#xFF0C;&#x4E59;&#x65B9;&#x79C1;&#x94A5;&#x6784;&#x5EFA;&#x5BC6;&#x6587;</span>
        <span class="hljs-keyword">byte</span>[] aCode = DHCoder.encrypt(aInput.getBytes(), aPublicKey,
                bPrivateKey);

        <span class="hljs-comment">// &#x7531;&#x4E59;&#x65B9;&#x516C;&#x94A5;&#xFF0C;&#x7532;&#x65B9;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] aDecode = DHCoder.decrypt(aCode, bPublicKey, aPrivateKey);
        String aOutput = (<span class="hljs-keyword">new</span> String(aDecode));

        System.err.println(<span class="hljs-string">&quot;&#x89E3;&#x5BC6;: &quot;</span> + aOutput);

        assertEquals(aInput, aOutput);

        System.err.println(<span class="hljs-string">&quot; ===============&#x53CD;&#x8FC7;&#x6765;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;================== &quot;</span>);
        String bInput = <span class="hljs-string">&quot;def &quot;</span>;
        System.err.println(<span class="hljs-string">&quot;&#x539F;&#x6587;: &quot;</span> + bInput);

        <span class="hljs-comment">// &#x7531;&#x4E59;&#x65B9;&#x516C;&#x94A5;&#xFF0C;&#x7532;&#x65B9;&#x79C1;&#x94A5;&#x6784;&#x5EFA;&#x5BC6;&#x6587;</span>
        <span class="hljs-keyword">byte</span>[] bCode = DHCoder.encrypt(bInput.getBytes(), bPublicKey,
                aPrivateKey);

        <span class="hljs-comment">// &#x7531;&#x7532;&#x65B9;&#x516C;&#x94A5;&#xFF0C;&#x4E59;&#x65B9;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] bDecode = DHCoder.decrypt(bCode, aPublicKey, bPrivateKey);
        String bOutput = (<span class="hljs-keyword">new</span> String(bDecode));

        System.err.println(<span class="hljs-string">&quot;&#x89E3;&#x5BC6;: &quot;</span> + bOutput);

        assertEquals(bInput, bOutput);
    }

}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x7532;&#x65B9;&#x516C;&#x94A5;:
MIHfMIGXBgkqhkiG9w0BAwEwgYkCQQD8poLOjhLKuibvzPcRDlJtsHiwXt7LzR60ogjzrhYXrgHz
W5Gkfm32NBPF4S7QiZvNEyrNUNmRUb3EPuc3WS4XAkBnhHGyepz0TukaScUUfbGpqvJE8FpDTWSG
kx0tFCcbnjUDC3H9c9oXkGmzLik1Yw4cIGI1TQ2iCmxBblC+eUykAgIBgANDAAJAdAWBVmIzqcko
Ej6qFjLDL2+Y3FPq1iRbnOyOpDj71yKaK1K+FhTv04B0zy4DKcvAASV7/Gv0W+bgqdmffRkqrQ==

&#x7532;&#x65B9;&#x79C1;&#x94A5;:
MIHRAgEAMIGXBgkqhkiG9w0BAwEwgYkCQQD8poLOjhLKuibvzPcRDlJtsHiwXt7LzR60ogjzrhYX
rgHzW5Gkfm32NBPF4S7QiZvNEyrNUNmRUb3EPuc3WS4XAkBnhHGyepz0TukaScUUfbGpqvJE8FpD
TWSGkx0tFCcbnjUDC3H9c9oXkGmzLik1Yw4cIGI1TQ2iCmxBblC+eUykAgIBgAQyAjACJRfy1LyR
eHyD+4Hfb+xR0uoIGR1oL9i9Nk6g2AAuaDPgEVWHn+QXID13yL/uDos=

&#x4E59;&#x65B9;&#x516C;&#x94A5;:
MIHfMIGXBgkqhkiG9w0BAwEwgYkCQQD8poLOjhLKuibvzPcRDlJtsHiwXt7LzR60ogjzrhYXrgHz
W5Gkfm32NBPF4S7QiZvNEyrNUNmRUb3EPuc3WS4XAkBnhHGyepz0TukaScUUfbGpqvJE8FpDTWSG
kx0tFCcbnjUDC3H9c9oXkGmzLik1Yw4cIGI1TQ2iCmxBblC+eUykAgIBgANDAAJAVEYSfBA+I9nr
dWw3OBv475C+eBrWBBYqt0m6/eu4ptuDQHwV4MmUtKAC2wc2nNrdb1wmBhY1X8RnWkJ1XmdDbQ==

&#x4E59;&#x65B9;&#x79C1;&#x94A5;:
MIHSAgEAMIGXBgkqhkiG9w0BAwEwgYkCQQD8poLOjhLKuibvzPcRDlJtsHiwXt7LzR60ogjzrhYX
rgHzW5Gkfm32NBPF4S7QiZvNEyrNUNmRUb3EPuc3WS4XAkBnhHGyepz0TukaScUUfbGpqvJE8FpD
TWSGkx0tFCcbnjUDC3H9c9oXkGmzLik1Yw4cIGI1TQ2iCmxBblC+eUykAgIBgAQzAjEAqaZiCdXp
2iNpdBlHRaO9ir70wo2n32xNlIzIX19VLSPCDdeUWkgRv4CEj/8k+/yd

&#x539F;&#x6587;: abc 
&#x89E3;&#x5BC6;: abc 
 ===============&#x53CD;&#x8FC7;&#x6765;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;================== 
&#x539F;&#x6587;: def 
&#x89E3;&#x5BC6;: def
</code></pre><p>&#x5982;&#x6211;&#x6240;&#x8A00;&#xFF0C;&#x7532;&#x4E59;&#x53CC;&#x65B9;&#x5728;&#x83B7;&#x5F97;&#x5BF9;&#x65B9;&#x516C;&#x94A5;&#x540E;&#x53EF;&#x4EE5;&#x5BF9;&#x53D1;&#x9001;&#x7ED9;&#x5BF9;&#x65B9;&#x7684;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x80FD;&#x5BF9;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6570;&#x636E;&#x89E3;&#x5BC6;&#xFF0C;&#x8FBE;&#x5230;&#x4E86;&#x6570;&#x636E;&#x5B89;&#x5168;&#x901A;&#x4FE1;&#x7684;&#x76EE;&#x7684;&#xFF01;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;DSA&#x6570;&#x5B57;&#x7B7E;&#x540D;&#xFF0C;&#x975E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7684;&#x53E6;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#x3002; </p>
<h2 id="19-dsa"><a name="19-dsa" class="anchor-navigation-ex-anchor" href="#19-dsa"><i class="fa fa-link" aria-hidden="true"></i></a>1.9. DSA</h2>
<p>DSA-Digital Signature Algorithm </p>
<p>&#x662F;Schnorr&#x548C;ElGamal&#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#x7684;&#x53D8;&#x79CD;&#xFF0C;&#x88AB;&#x7F8E;&#x56FD;NIST&#x4F5C;&#x4E3A;DSS(DigitalSignature Standard)&#x3002;</p>
<p>&#x7B80;&#x5355;&#x7684;&#x8BF4;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x66F4;&#x9AD8;&#x7EA7;&#x7684;&#x9A8C;&#x8BC1;&#x65B9;&#x5F0F;&#xFF0C;&#x7528;&#x4F5C;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x3002;&#x4E0D;&#x5355;&#x5355;&#x53EA;&#x6709;&#x516C;&#x94A5;&#x3001;&#x79C1;&#x94A5;&#xFF0C;&#x8FD8;&#x6709;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x3002;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x751F;&#x6210;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#xFF0C;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x6570;&#x636E;&#x53CA;&#x7B7E;&#x540D;&#x3002;
&#x5982;&#x679C;&#x6570;&#x636E;&#x548C;&#x7B7E;&#x540D;&#x4E0D;&#x5339;&#x914D;&#x5219;&#x8BA4;&#x4E3A;&#x9A8C;&#x8BC1;&#x5931;&#x8D25;&#xFF01;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x6821;&#x9A8C;&#x6570;&#x636E;&#x5728;&#x4F20;&#x8F93;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E0D;&#x88AB;&#x4FEE;&#x6539;&#x3002;&#x6570;&#x5B57;&#x7B7E;&#x540D;&#xFF0C;&#x662F;&#x5355;&#x5411;&#x52A0;&#x5BC6;&#x7684;&#x5347;&#x7EA7;&#xFF01; </p>
<ol>
<li><img src="images/007-dsa-001.jpg" alt=""></li>
<li><img src="images/007-dsa-002.jpg" alt=""></li>
</ol>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.security.KeyFactory;
<span class="hljs-keyword">import</span> java.security.KeyPair;
<span class="hljs-keyword">import</span> java.security.KeyPairGenerator;
<span class="hljs-keyword">import</span> java.security.PrivateKey;
<span class="hljs-keyword">import</span> java.security.PublicKey;
<span class="hljs-keyword">import</span> java.security.SecureRandom;
<span class="hljs-keyword">import</span> java.security.Signature;
<span class="hljs-keyword">import</span> java.security.interfaces.DSAPrivateKey;
<span class="hljs-keyword">import</span> java.security.interfaces.DSAPublicKey;
<span class="hljs-keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.X509EncodedKeySpec;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * DSA&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DSACoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ALGORITHM = <span class="hljs-string">&quot;DSA&quot;</span>;

    <span class="hljs-comment">/**
     * &#x9ED8;&#x8BA4;&#x5BC6;&#x94A5;&#x5B57;&#x8282;&#x6570;
     * 
     * &lt;pre&gt;
     * DSA 
     * Default Keysize 1024  
     * Keysize must be a multiple of 64, ranging from 512 to 1024 (inclusive).
     * &lt;/pre&gt;
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> KEY_SIZE = <span class="hljs-number">1024</span>;

    <span class="hljs-comment">/**
     * &#x9ED8;&#x8BA4;&#x79CD;&#x5B50;
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_SEED = <span class="hljs-string">&quot;0f22507a10bbddd07d8a3082122966e3&quot;</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PUBLIC_KEY = <span class="hljs-string">&quot;DSAPublicKey&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PRIVATE_KEY = <span class="hljs-string">&quot;DSAPrivateKey&quot;</span>;

    <span class="hljs-comment">/**
     * &#x7528;&#x79C1;&#x94A5;&#x5BF9;&#x4FE1;&#x606F;&#x751F;&#x6210;&#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x52A0;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> privateKey
     *            &#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">sign</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String privateKey)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x89E3;&#x5BC6;&#x7531;base64&#x7F16;&#x7801;&#x7684;&#x79C1;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(privateKey);

        <span class="hljs-comment">// &#x6784;&#x9020;PKCS8EncodedKeySpec&#x5BF9;&#x8C61;</span>
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(keyBytes);

        <span class="hljs-comment">// KEY_ALGORITHM &#x6307;&#x5B9A;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</span>
        KeyFactory keyFactory = KeyFactory.getInstance(ALGORITHM);

        <span class="hljs-comment">// &#x53D6;&#x79C1;&#x94A5;&#x5319;&#x5BF9;&#x8C61;</span>
        PrivateKey priKey = keyFactory.generatePrivate(pkcs8KeySpec);

        <span class="hljs-comment">// &#x7528;&#x79C1;&#x94A5;&#x5BF9;&#x4FE1;&#x606F;&#x751F;&#x6210;&#x6570;&#x5B57;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(keyFactory.getAlgorithm());
        signature.initSign(priKey);
        signature.update(data);

        <span class="hljs-keyword">return</span> encryptBASE64(signature.sign());
    }

    <span class="hljs-comment">/**
     * &#x6821;&#x9A8C;&#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     *            &#x52A0;&#x5BC6;&#x6570;&#x636E;
     * <span class="hljs-doctag">@param</span> publicKey
     *            &#x516C;&#x94A5;
     * <span class="hljs-doctag">@param</span> sign
     *            &#x6570;&#x5B57;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@return</span> &#x6821;&#x9A8C;&#x6210;&#x529F;&#x8FD4;&#x56DE;true &#x5931;&#x8D25;&#x8FD4;&#x56DE;false
     * <span class="hljs-doctag">@throws</span> Exception
     * 
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verify</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String publicKey, String sign)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{

        <span class="hljs-comment">// &#x89E3;&#x5BC6;&#x7531;base64&#x7F16;&#x7801;&#x7684;&#x516C;&#x94A5;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(publicKey);

        <span class="hljs-comment">// &#x6784;&#x9020;X509EncodedKeySpec&#x5BF9;&#x8C61;</span>
        X509EncodedKeySpec keySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);

        <span class="hljs-comment">// ALGORITHM &#x6307;&#x5B9A;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;</span>
        KeyFactory keyFactory = KeyFactory.getInstance(ALGORITHM);

        <span class="hljs-comment">// &#x53D6;&#x516C;&#x94A5;&#x5319;&#x5BF9;&#x8C61;</span>
        PublicKey pubKey = keyFactory.generatePublic(keySpec);

        Signature signature = Signature.getInstance(keyFactory.getAlgorithm());
        signature.initVerify(pubKey);
        signature.update(data);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&#x662F;&#x5426;&#x6B63;&#x5E38;</span>
        <span class="hljs-keyword">return</span> signature.verify(decryptBASE64(sign));
    }

    <span class="hljs-comment">/**
     * &#x751F;&#x6210;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> seed
     *            &#x79CD;&#x5B50;
     * <span class="hljs-doctag">@return</span> &#x5BC6;&#x94A5;&#x5BF9;&#x8C61;
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">(String seed)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyPairGenerator keygen = KeyPairGenerator.getInstance(ALGORITHM);
        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x968F;&#x673A;&#x4EA7;&#x751F;&#x5668;</span>
        SecureRandom secureRandom = <span class="hljs-keyword">new</span> SecureRandom();
        secureRandom.setSeed(seed.getBytes());
        keygen.initialize(KEY_SIZE, secureRandom);

        KeyPair keys = keygen.genKeyPair();

        DSAPublicKey publicKey = (DSAPublicKey) keys.getPublic();
        DSAPrivateKey privateKey = (DSAPrivateKey) keys.getPrivate();

        Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;(<span class="hljs-number">2</span>);
        map.put(PUBLIC_KEY, publicKey);
        map.put(PRIVATE_KEY, privateKey);

        <span class="hljs-keyword">return</span> map;
    }

    <span class="hljs-comment">/**
     * &#x9ED8;&#x8BA4;&#x751F;&#x6210;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span> &#x5BC6;&#x94A5;&#x5BF9;&#x8C61;
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-keyword">return</span> initKey(DEFAULT_SEED);
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PRIVATE_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPublicKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PUBLIC_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DSACoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        String inputStr = <span class="hljs-string">&quot;abc&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-comment">// &#x6784;&#x5EFA;&#x5BC6;&#x94A5;</span>
        Map&lt;String, Object&gt; keyMap = DSACoder.initKey();

        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x5BC6;&#x94A5;</span>
        String publicKey = DSACoder.getPublicKey(keyMap);
        String privateKey = DSACoder.getPrivateKey(keyMap);

        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;:\r&quot;</span> + publicKey);
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;:\r&quot;</span> + privateKey);

        <span class="hljs-comment">// &#x4EA7;&#x751F;&#x7B7E;&#x540D;</span>
        String sign = DSACoder.sign(data, privateKey);
        System.err.println(<span class="hljs-string">&quot;&#x7B7E;&#x540D;:\r&quot;</span> + sign);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;</span>
        <span class="hljs-keyword">boolean</span> status = DSACoder.verify(data, publicKey, sign);
        System.err.println(<span class="hljs-string">&quot;&#x72B6;&#x6001;:\r&quot;</span> + status);
        assertTrue(status);

    }

}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x516C;&#x94A5;:
MIIBtzCCASwGByqGSM44BAEwggEfAoGBAP1/U4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2USZp
RV1AIlH7WT2NWPq/xfW6MPbLm1Vs14E7gB00b/JmYLdrmVClpJ+f6AR7ECLCT7up1/63xhv4O1fn
xqimFQ8E+4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmCouuE
C/BYHPUCgYEA9+GghdabPd7LvKtcNrhXuXmUr7v6OuqC+VdMCz0HgmdRWVeOutRZT+ZxBxCBgLRJ
FnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN/C/ohNWLx+2J6ASQ7zKTxvqhRkImo
g9/hWuWfBpKLZl6Ae1UlZAFMO/7PSSoDgYQAAoGAIu4RUlcQLp49PI0MrbssOY+3uySVnp0TULSv
5T4VaHoKzsLHgGTrwOvsGA+V3yCNl2WDu3D84bSLF7liTWgOj+SMOEaPk4VyRTlLXZWGPsf1Mfd9
21XAbMeVyKDSHHVGbMjBScajf3bXooYQMlyoHiOt/WrCo+mv7efstMM0PGo=

&#x79C1;&#x94A5;:
MIIBTAIBADCCASwGByqGSM44BAEwggEfAoGBAP1/U4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2
USZpRV1AIlH7WT2NWPq/xfW6MPbLm1Vs14E7gB00b/JmYLdrmVClpJ+f6AR7ECLCT7up1/63xhv4
O1fnxqimFQ8E+4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmC
ouuEC/BYHPUCgYEA9+GghdabPd7LvKtcNrhXuXmUr7v6OuqC+VdMCz0HgmdRWVeOutRZT+ZxBxCB
gLRJFnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN/C/ohNWLx+2J6ASQ7zKTxvqhR
kImog9/hWuWfBpKLZl6Ae1UlZAFMO/7PSSoEFwIVAIegLUtmm2oQKQJTOiLugHTSjl/q

&#x7B7E;&#x540D;:
MC0CFQCMg0J/uZmF8GuRpr3TNq48w60nDwIUJCyYNah+HtbU6NcQfy8Ac6LeLQs=

&#x72B6;&#x6001;:
true
</code></pre><p>&#x6CE8;&#x610F;&#x72B6;&#x6001;&#x4E3A;true&#xFF0C;&#x5C31;&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#xFF01;</p>
<h2 id="110-ecc"><a name="110-ecc" class="anchor-navigation-ex-anchor" href="#110-ecc"><i class="fa fa-link" aria-hidden="true"></i></a>1.10. ECC</h2>
<p>ECC-Elliptic Curves Cryptography&#xFF0C;&#x692D;&#x5706;&#x66F2;&#x7EBF;&#x5BC6;&#x7801;&#x7F16;&#x7801;&#x5B66;&#xFF0C;&#x662F;&#x76EE;&#x524D;&#x5DF2;&#x77E5;&#x7684;&#x516C;&#x94A5;&#x4F53;&#x5236;&#x4E2D;&#xFF0C;&#x5BF9;&#x6BCF;&#x6BD4;&#x7279;&#x6240;&#x63D0;&#x4F9B;&#x52A0;&#x5BC6;&#x5F3A;&#x5EA6;&#x6700;&#x9AD8;&#x7684;&#x4E00;&#x79CD;&#x4F53;&#x5236;&#x3002;&#x5728;&#x8F6F;&#x4EF6;&#x6CE8;&#x518C;&#x4FDD;&#x62A4;&#x65B9;&#x9762;&#x8D77;&#x5230;&#x5F88;&#x5927;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x5E8F;&#x5217;&#x53F7;&#x901A;&#x5E38;&#x7531;&#x8BE5;&#x7B97;&#x6CD5;&#x4EA7;&#x751F;&#x3002; </p>
<p>&#x5F53;&#x6211;&#x5F00;&#x59CB;&#x6574;&#x7406;&#x300A;Java&#x52A0;&#x5BC6;&#x6280;&#x672F;&#xFF08;&#x4E8C;&#xFF09;&#x300B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x5C31;&#x5DF2;&#x7ECF;&#x5728;&#x5F00;&#x59CB;&#x7814;&#x7A76;ECC&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5173;&#x4E8E;Java&#x5B9E;&#x73B0;ECC&#x7B97;&#x6CD5;&#x7684;&#x8D44;&#x6599;&#x5B9E;&#x5728;&#x662F;&#x592A;&#x5C11;&#x4E86;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x56FD;&#x5185;&#x8FD8;&#x662F;&#x56FD;&#x5916;&#x7684; &#x8D44;&#x6599;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x5B98;&#x65B9;&#x8FD8;&#x662F;&#x975E;&#x5B98;&#x65B9;&#x7684;&#x89E3;&#x91CA;&#xFF0C;&#x6700;&#x7EC8;&#x53EA;&#x6709;&#x4E00;&#x79CD;&#x7B54;&#x6848;&#x2014;&#x2014;ECC&#x7B97;&#x6CD5;&#x5728;jdk1.5&#x540E;&#x52A0;&#x5165;&#x652F;&#x6301;&#xFF0C;&#x76EE;&#x524D;&#x4EC5;&#x4EC5;&#x53EA;&#x80FD;&#x5B8C;&#x6210;&#x5BC6;&#x94A5;&#x7684;&#x751F;&#x6210;&#x4E0E;&#x89E3;&#x6790;&#x3002; &#x5982;&#x679C;&#x60F3;&#x8981;&#x83B7;&#x5F97;ECC&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;&#x786C;&#x4EF6;&#x5B8C;&#x6210;&#x52A0;&#x5BC6;/&#x89E3;&#x5BC6;&#xFF08;ECC&#x7B97;&#x6CD5;&#x76F8;&#x5F53;&#x8017;&#x8D39;&#x8D44;&#x6E90;&#xFF0C;&#x5982;&#x679C;&#x5355;&#x7EAF;&#x4F7F;&#x7528;CPU&#x8FDB;&#x884C;&#x52A0;&#x5BC6;/&#x89E3;&#x5BC6;&#xFF0C;&#x6548;&#x7387;&#x4F4E;&#x4E0B;&#xFF09;&#xFF0C;&#x6D89;&#x53CA;&#x5230;Java Card&#x9886;&#x57DF;&#xFF0C;PKCS#11&#x3002; &#x5176;&#x5B9E;&#xFF0C;PKCS#11&#x914D;&#x7F6E;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x7F3A;&#x4E4F;&#x786C;&#x4EF6;&#x8BBE;&#x5907;&#xFF0C;&#x65E0;&#x6CD5;&#x5C1D;&#x8BD5;&#xFF01; </p>
<p>&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x6211;&#x7167;&#x65E7;&#x63D0;&#x4F9B;&#x76F8;&#x5E94;&#x7684;Java&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#xFF0C;&#x4EE5;&#x4F9B;&#x5927;&#x5BB6;&#x53C2;&#x8003;&#x3002; </p>
<p>&#x901A;&#x8FC7;java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;Coder&#x7C7B;&#x89C1;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> java.security.KeyFactory;
<span class="hljs-keyword">import</span> java.security.interfaces.ECPrivateKey;
<span class="hljs-keyword">import</span> java.security.interfaces.ECPublicKey;
<span class="hljs-keyword">import</span> java.security.spec.ECFieldF2m;
<span class="hljs-keyword">import</span> java.security.spec.ECParameterSpec;
<span class="hljs-keyword">import</span> java.security.spec.ECPoint;
<span class="hljs-keyword">import</span> java.security.spec.ECPrivateKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.ECPublicKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.EllipticCurve;
<span class="hljs-keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.X509EncodedKeySpec;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;
<span class="hljs-keyword">import</span> javax.crypto.NullCipher;

<span class="hljs-keyword">import</span> sun.security.ec.ECKeyFactory;
<span class="hljs-keyword">import</span> sun.security.ec.ECPrivateKeyImpl;
<span class="hljs-keyword">import</span> sun.security.ec.ECPublicKeyImpl;

<span class="hljs-comment">/**
 * ECC&#x5B89;&#x5168;&#x7F16;&#x7801;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ECCCoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ALGORITHM = <span class="hljs-string">&quot;EC&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PUBLIC_KEY = <span class="hljs-string">&quot;ECCPublicKey&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String PRIVATE_KEY = <span class="hljs-string">&quot;ECCPrivateKey&quot;</span>;

    <span class="hljs-comment">/**
     * &#x89E3;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> key
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decrypt(<span class="hljs-keyword">byte</span>[] data, String key) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x5BC6;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(key);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PKCS8EncodedKeySpec pkcs8KeySpec = <span class="hljs-keyword">new</span> PKCS8EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = ECKeyFactory.INSTANCE;

        ECPrivateKey priKey = (ECPrivateKey) keyFactory
                .generatePrivate(pkcs8KeySpec);

        ECPrivateKeySpec ecPrivateKeySpec = <span class="hljs-keyword">new</span> ECPrivateKeySpec(priKey.getS(),
                priKey.getParams());

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x89E3;&#x5BC6;</span>
        <span class="hljs-comment">// TODO Chipher&#x4E0D;&#x652F;&#x6301;EC&#x7B97;&#x6CD5; &#x672A;&#x80FD;&#x5B9E;&#x73B0;</span>
        Cipher cipher = <span class="hljs-keyword">new</span> NullCipher();
        <span class="hljs-comment">// Cipher.getInstance(ALGORITHM, keyFactory.getProvider());</span>
        cipher.init(Cipher.DECRYPT_MODE, priKey, ecPrivateKeySpec.getParams());

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x52A0;&#x5BC6;&lt;br&gt;
     * &#x7528;&#x516C;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> privateKey
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encrypt(<span class="hljs-keyword">byte</span>[] data, String privateKey)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x5BF9;&#x516C;&#x94A5;&#x89E3;&#x5BC6;</span>
        <span class="hljs-keyword">byte</span>[] keyBytes = decryptBASE64(privateKey);

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        X509EncodedKeySpec x509KeySpec = <span class="hljs-keyword">new</span> X509EncodedKeySpec(keyBytes);
        KeyFactory keyFactory = ECKeyFactory.INSTANCE;

        ECPublicKey pubKey = (ECPublicKey) keyFactory
                .generatePublic(x509KeySpec);

        ECPublicKeySpec ecPublicKeySpec = <span class="hljs-keyword">new</span> ECPublicKeySpec(pubKey.getW(),
                pubKey.getParams());

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        <span class="hljs-comment">// TODO Chipher&#x4E0D;&#x652F;&#x6301;EC&#x7B97;&#x6CD5; &#x672A;&#x80FD;&#x5B9E;&#x73B0;</span>
        Cipher cipher = <span class="hljs-keyword">new</span> NullCipher();
        <span class="hljs-comment">// Cipher.getInstance(ALGORITHM, keyFactory.getProvider());</span>
        cipher.init(Cipher.ENCRYPT_MODE, pubKey, ecPublicKeySpec.getParams());

        <span class="hljs-keyword">return</span> cipher.doFinal(data);
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PRIVATE_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x53D6;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyMap
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPublicKey</span><span class="hljs-params">(Map&lt;String, Object&gt; keyMap)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Key key = (Key) keyMap.get(PUBLIC_KEY);

        <span class="hljs-keyword">return</span> encryptBASE64(key.getEncoded());
    }

    <span class="hljs-comment">/**
     * &#x521D;&#x59CB;&#x5316;&#x5BC6;&#x94A5;
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map&lt;String, Object&gt; <span class="hljs-title">initKey</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        BigInteger x1 = <span class="hljs-keyword">new</span> BigInteger(
                <span class="hljs-string">&quot;2fe13c0537bbc11acaa07d793de4e6d5e5c94eee8&quot;</span>, <span class="hljs-number">16</span>);
        BigInteger x2 = <span class="hljs-keyword">new</span> BigInteger(
                <span class="hljs-string">&quot;289070fb05d38ff58321f2e800536d538ccdaa3d9&quot;</span>, <span class="hljs-number">16</span>);

        ECPoint g = <span class="hljs-keyword">new</span> ECPoint(x1, x2);

        <span class="hljs-comment">// the order of generator</span>
        BigInteger n = <span class="hljs-keyword">new</span> BigInteger(
                <span class="hljs-string">&quot;5846006549323611672814741753598448348329118574063&quot;</span>, <span class="hljs-number">10</span>);
        <span class="hljs-comment">// the cofactor</span>
        <span class="hljs-keyword">int</span> h = <span class="hljs-number">2</span>;
        <span class="hljs-keyword">int</span> m = <span class="hljs-number">163</span>;
        <span class="hljs-keyword">int</span>[] ks = { <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span> };
        ECFieldF2m ecField = <span class="hljs-keyword">new</span> ECFieldF2m(m, ks);
        <span class="hljs-comment">// y^2+xy=x^3+x^2+1</span>
        BigInteger a = <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">2</span>);
        BigInteger b = <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">2</span>);

        EllipticCurve ellipticCurve = <span class="hljs-keyword">new</span> EllipticCurve(ecField, a, b);

        ECParameterSpec ecParameterSpec = <span class="hljs-keyword">new</span> ECParameterSpec(ellipticCurve, g,
                n, h);
        <span class="hljs-comment">// &#x516C;&#x94A5;</span>
        ECPublicKey publicKey = <span class="hljs-keyword">new</span> ECPublicKeyImpl(g, ecParameterSpec);

        BigInteger s = <span class="hljs-keyword">new</span> BigInteger(
                <span class="hljs-string">&quot;1234006549323611672814741753598448348329118574063&quot;</span>, <span class="hljs-number">10</span>);
        <span class="hljs-comment">// &#x79C1;&#x94A5;</span>
        ECPrivateKey privateKey = <span class="hljs-keyword">new</span> ECPrivateKeyImpl(s, ecParameterSpec);

        Map&lt;String, Object&gt; keyMap = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;(<span class="hljs-number">2</span>);

        keyMap.put(PUBLIC_KEY, publicKey);
        keyMap.put(PRIVATE_KEY, privateKey);

        <span class="hljs-keyword">return</span> keyMap;
    }

}
</code></pre>
<p>&#x8BF7;&#x6CE8;&#x610F;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#x7684;TODO&#x5185;&#x5BB9;&#xFF0C;&#x518D;&#x6B21;&#x63D0;&#x9192;&#x6CE8;&#x610F;&#xFF0C;<strong>Chipher&#x4E0D;&#x652F;&#x6301;EC&#x7B97;&#x6CD5;</strong> &#xFF0C;&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;&#x3002;<strong>Chipher&#x3001;Signature&#x3001;KeyPairGenerator&#x3001;KeyAgreement&#x3001;SecretKey&#x5747;&#x4E0D;&#x652F;&#x6301;EC&#x7B97;&#x6CD5;&#x3002;</strong>&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x6267;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;NullCipher&#x7C7B;&#xFF0C;&#x9A8C;&#x8BC1;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x7167;&#x65E7;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> java.security.spec.ECFieldF2m;
<span class="hljs-keyword">import</span> java.security.spec.ECParameterSpec;
<span class="hljs-keyword">import</span> java.security.spec.ECPoint;
<span class="hljs-keyword">import</span> java.security.spec.ECPrivateKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.ECPublicKeySpec;
<span class="hljs-keyword">import</span> java.security.spec.EllipticCurve;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ECCCoderTest</span> </span>{

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        String inputStr = <span class="hljs-string">&quot;abc&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        Map&lt;String, Object&gt; keyMap = ECCCoder.initKey();

        String publicKey = ECCCoder.getPublicKey(keyMap);
        String privateKey = ECCCoder.getPrivateKey(keyMap);
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;: \n&quot;</span> + publicKey);
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#xFF1A; \n&quot;</span> + privateKey);

        <span class="hljs-keyword">byte</span>[] encodedData = ECCCoder.encrypt(data, publicKey);

        <span class="hljs-keyword">byte</span>[] decodedData = ECCCoder.decrypt(encodedData, privateKey);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);
    }
}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x516C;&#x94A5;: 
MEAwEAYHKoZIzj0CAQYFK4EEAAEDLAAEAv4TwFN7vBGsqgfXk95ObV5clO7oAokHD7BdOP9YMh8u
gAU21TjM2qPZ

&#x79C1;&#x94A5;&#xFF1A; 
MDICAQAwEAYHKoZIzj0CAQYFK4EEAAEEGzAZAgEBBBTYJsR3BN7TFw7JHcAHFkwNmfil7w==

&#x52A0;&#x5BC6;&#x524D;: abc

&#x89E3;&#x5BC6;&#x540E;: abc
</code></pre><p>&#x672C;&#x7BC7;&#x7684;&#x4E3B;&#x8981;&#x5185;&#x5BB9;&#x4E3A;Java&#x8BC1;&#x4E66;&#x4F53;&#x7CFB;&#x7684;&#x5B9E;&#x73B0;&#x3002; </p>
<p>&#x5728;&#x6784;&#x5EFA;Java&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x8BC1;&#x4E66;&#x7684;&#x5236;&#x4F5C;&#x3002; </p>
<ol>
<li>&#x751F;&#x6210;keyStroe&#x6587;&#x4EF6; </li>
</ol>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E0B;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>keytool -genkey -validity 36000 -alias www.zlex.org -keyalg RSA -keystore d:\zlex.keystore
</code></pre><p>&#x5176;&#x4E2D; </p>
<ul>
<li>genkey&#x8868;&#x793A;&#x751F;&#x6210;&#x5BC6;&#x94A5; </li>
<li>validity&#x6307;&#x5B9A;&#x8BC1;&#x4E66;&#x6709;&#x6548;&#x671F;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;36000&#x5929; </li>
<li>alias&#x6307;&#x5B9A;&#x522B;&#x540D;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;www.zlex.org </li>
<li>keyalg&#x6307;&#x5B9A;&#x7B97;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;RSA </li>
<li>keystore&#x6307;&#x5B9A;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;d:\zlex.keystore </li>
</ul>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x7684;&#x5BC6;&#x7801;&#x4E3A; 123456 </p>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;keystore&#x5BC6;&#x7801;&#xFF1A;
&#x518D;&#x6B21;&#x8F93;&#x5165;&#x65B0;&#x5BC6;&#x7801;:
&#x60A8;&#x7684;&#x540D;&#x5B57;&#x4E0E;&#x59D3;&#x6C0F;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
  [Unknown]&#xFF1A;  www.zlex.org
&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x5355;&#x4F4D;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
  [Unknown]&#xFF1A;  zlex
&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
  [Unknown]&#xFF1A;  zlex
&#x60A8;&#x6240;&#x5728;&#x7684;&#x57CE;&#x5E02;&#x6216;&#x533A;&#x57DF;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
  [Unknown]&#xFF1A;  BJ
&#x60A8;&#x6240;&#x5728;&#x7684;&#x5DDE;&#x6216;&#x7701;&#x4EFD;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
  [Unknown]&#xFF1A;  BJ
&#x8BE5;&#x5355;&#x4F4D;&#x7684;&#x4E24;&#x5B57;&#x6BCD;&#x56FD;&#x5BB6;&#x4EE3;&#x7801;&#x662F;&#x4EC0;&#x4E48;
  [Unknown]&#xFF1A;  CN
CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN &#x6B63;&#x786E;&#x5417;&#xFF1F;
  [&#x5426;]&#xFF1A;  Y

&#x8F93;&#x5165;&lt;tomcat&gt;&#x7684;&#x4E3B;&#x5BC6;&#x7801;
        &#xFF08;&#x5982;&#x679C;&#x548C; keystore &#x5BC6;&#x7801;&#x76F8;&#x540C;&#xFF0C;&#x6309;&#x56DE;&#x8F66;&#xFF09;&#xFF1A;
&#x518D;&#x6B21;&#x8F93;&#x5165;&#x65B0;&#x5BC6;&#x7801;:
</code></pre><p>&#x8FD9;&#x65F6;&#xFF0C;&#x5728;D&#x76D8;&#x4E0B;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;zlex.keystore&#x7684;&#x6587;&#x4EF6;&#x3002; </p>
<ol>
<li>&#x751F;&#x6210;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66; </li>
</ol>
<p>&#x5149;&#x6709;keyStore&#x6587;&#x4EF6;&#x662F;&#x4E0D;&#x591F;&#x7684;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x8BC1;&#x4E66;&#x6587;&#x4EF6;&#xFF0C;&#x8BC1;&#x4E66;&#x624D;&#x662F;&#x76F4;&#x63A5;&#x63D0;&#x4F9B;&#x7ED9;&#x5916;&#x754C;&#x4F7F;&#x7528;&#x7684;&#x516C;&#x94A5;&#x51ED;&#x8BC1;&#x3002; </p>
<p>&#x5BFC;&#x51FA;&#x8BC1;&#x4E66;&#xFF1A;</p>
<pre><code>keytool -export -keystore d:\zlex.keystore -alias www.zlex.org -file d:\zlex.cer -rfc
</code></pre><p>&#x5176;&#x4E2D; </p>
<ul>
<li>export&#x6307;&#x5B9A;&#x4E3A;&#x5BFC;&#x51FA;&#x64CD;&#x4F5C; </li>
<li>keystore&#x6307;&#x5B9A;keystore&#x6587;&#x4EF6; </li>
<li>alias&#x6307;&#x5B9A;&#x5BFC;&#x51FA;keystore&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x522B;&#x540D; </li>
<li>file&#x6307;&#x5411;&#x5BFC;&#x51FA;&#x8DEF;&#x5F84; </li>
<li>rfc&#x4EE5;&#x6587;&#x672C;&#x683C;&#x5F0F;&#x8F93;&#x51FA;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4EE5;BASE64&#x7F16;&#x7801;&#x8F93;&#x51FA; </li>
</ul>
<p>&#x8FD9;&#x91CC;&#x7684;&#x5BC6;&#x7801;&#x662F; 123456 </p>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;keystore&#x5BC6;&#x7801;&#xFF1A;
&#x4FDD;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x8BA4;&#x8BC1; &lt;d:\zlex.cer&gt;
</code></pre><p><strong>&#x5F53;&#x7136;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x662F;&#x9700;&#x8981;&#x5BFC;&#x5165;&#x8BC1;&#x4E66;&#x7684;&#xFF01;</strong></p>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;&#x5B8C;&#x6210;CAS&#x5355;&#x70B9;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x7684;&#x6784;&#x5EFA;&#xFF01; </p>
<p>Ok&#xFF0C;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#x5B8C;&#x6210;&#xFF0C;&#x5F00;&#x59CB;Java&#x5B9E;&#x73B0;&#xFF01; </p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.io.FileInputStream;
<span class="hljs-keyword">import</span> java.security.KeyStore;
<span class="hljs-keyword">import</span> java.security.PrivateKey;
<span class="hljs-keyword">import</span> java.security.PublicKey;
<span class="hljs-keyword">import</span> java.security.Signature;
<span class="hljs-keyword">import</span> java.security.cert.Certificate;
<span class="hljs-keyword">import</span> java.security.cert.CertificateFactory;
<span class="hljs-keyword">import</span> java.security.cert.X509Certificate;
<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;

<span class="hljs-comment">/**
 * &#x8BC1;&#x4E66;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateCoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{


    <span class="hljs-comment">/**
     * Java&#x5BC6;&#x94A5;&#x5E93;(Java Key Store&#xFF0C;JKS)KEY_STORE
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_STORE = <span class="hljs-string">&quot;JKS&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String X509 = <span class="hljs-string">&quot;X.509&quot;</span>;

    <span class="hljs-comment">/**
     * &#x7531;KeyStore&#x83B7;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PrivateKey <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(String keyStorePath, String alias,
            String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyStore ks = getKeyStore(keyStorePath, password);
        PrivateKey key = (PrivateKey) ks.getKey(alias, password.toCharArray());
        <span class="hljs-keyword">return</span> key;
    }

    <span class="hljs-comment">/**
     * &#x7531;Certificate&#x83B7;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PublicKey <span class="hljs-title">getPublicKey</span><span class="hljs-params">(String certificatePath)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Certificate certificate = getCertificate(certificatePath);
        PublicKey key = certificate.getPublicKey();
        <span class="hljs-keyword">return</span> key;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;Certificate
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Certificate <span class="hljs-title">getCertificate</span><span class="hljs-params">(String certificatePath)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        CertificateFactory certificateFactory = CertificateFactory
                .getInstance(X509);
        FileInputStream in = <span class="hljs-keyword">new</span> FileInputStream(certificatePath);

        Certificate certificate = certificateFactory.generateCertificate(in);
        in.close();

        <span class="hljs-keyword">return</span> certificate;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Certificate <span class="hljs-title">getCertificate</span><span class="hljs-params">(String keyStorePath,
            String alias, String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyStore ks = getKeyStore(keyStorePath, password);
        Certificate certificate = ks.getCertificate(alias);

        <span class="hljs-keyword">return</span> certificate;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;KeyStore
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> KeyStore <span class="hljs-title">getKeyStore</span><span class="hljs-params">(String keyStorePath, String password)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        FileInputStream is = <span class="hljs-keyword">new</span> FileInputStream(keyStorePath);
        KeyStore ks = KeyStore.getInstance(KEY_STORE);
        ks.load(is, password.toCharArray());
        is.close();
        <span class="hljs-keyword">return</span> ks;
    }

    <span class="hljs-comment">/**
     * &#x79C1;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String keyStorePath,
            String alias, String password) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = getPrivateKey(keyStorePath, alias, password);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(privateKey.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x79C1;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String keyStorePath,
            String alias, String password) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = getPrivateKey(keyStorePath, alias, password);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(privateKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x516C;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String certificatePath)
            <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = getPublicKey(certificatePath);
        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(publicKey.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x516C;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String certificatePath)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = getPublicKey(certificatePath);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(publicKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(String certificatePath)</span> </span>{
        <span class="hljs-keyword">return</span> verifyCertificate(<span class="hljs-keyword">new</span> Date(), certificatePath);
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;
     * 
     * <span class="hljs-doctag">@param</span> date
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, String certificatePath)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// &#x53D6;&#x5F97;&#x8BC1;&#x4E66;</span>
            Certificate certificate = getCertificate(certificatePath);
            <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;</span>
            status = verifyCertificate(date, certificate);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;
     * 
     * <span class="hljs-doctag">@param</span> date
     * <span class="hljs-doctag">@param</span> certificate
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, Certificate certificate)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            X509Certificate x509Certificate = (X509Certificate) certificate;
            x509Certificate.checkValidity(date);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">sign</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] sign, String keyStorePath, String alias,
            String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x8BC1;&#x4E66;</span>
        X509Certificate x509Certificate = (X509Certificate) getCertificate(
                keyStorePath, alias, password);
        <span class="hljs-comment">// &#x83B7;&#x53D6;&#x79C1;&#x94A5;</span>
        KeyStore ks = getKeyStore(keyStorePath, password);
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = (PrivateKey) ks.getKey(alias, password
                .toCharArray());

        <span class="hljs-comment">// &#x6784;&#x5EFA;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(x509Certificate
                .getSigAlgName());
        signature.initSign(privateKey);
        signature.update(sign);
        <span class="hljs-keyword">return</span> encryptBASE64(signature.sign());
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> sign
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verify</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String sign,
            String certificatePath)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x8BC1;&#x4E66;</span>
        X509Certificate x509Certificate = (X509Certificate) getCertificate(certificatePath);
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = x509Certificate.getPublicKey();
        <span class="hljs-comment">// &#x6784;&#x5EFA;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(x509Certificate
                .getSigAlgName());
        signature.initVerify(publicKey);
        signature.update(data);

        <span class="hljs-keyword">return</span> signature.verify(decryptBASE64(sign));

    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, String keyStorePath,
            String alias, String password)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            Certificate certificate = getCertificate(keyStorePath, alias,
                    password);
            status = verifyCertificate(date, certificate);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(String keyStorePath, String alias,
            String password)</span> </span>{
        <span class="hljs-keyword">return</span> verifyCertificate(<span class="hljs-keyword">new</span> Date(), keyStorePath, alias, password);
    }
}
</code></pre>
<p>&#x518D;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java">
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateCoderTest</span> </span>{
    <span class="hljs-keyword">private</span> String password = <span class="hljs-string">&quot;123456&quot;</span>;
    <span class="hljs-keyword">private</span> String alias = <span class="hljs-string">&quot;www.zlex.org&quot;</span>;
    <span class="hljs-keyword">private</span> String certificatePath = <span class="hljs-string">&quot;d:/zlex.cer&quot;</span>;
    <span class="hljs-keyword">private</span> String keyStorePath = <span class="hljs-string">&quot;d:/zlex.keystore&quot;</span>;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);
        String inputStr = <span class="hljs-string">&quot;Ceritifcate&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encrypt = CertificateCoder.encryptByPublicKey(data,
                certificatePath);

        <span class="hljs-keyword">byte</span>[] decrypt = CertificateCoder.decryptByPrivateKey(encrypt,
                keyStorePath, alias, password);
        String outputStr = <span class="hljs-keyword">new</span> String(decrypt);

        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x6570;&#x636E;&#x4E00;&#x81F4;</span>
        assertArrayEquals(data, decrypt);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x6709;&#x6548;</span>
        assertTrue(CertificateCoder.verifyCertificate(certificatePath));

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSign</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);

        String inputStr = <span class="hljs-string">&quot;sign&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encodedData = CertificateCoder.encryptByPrivateKey(data,
                keyStorePath, alias, password);

        <span class="hljs-keyword">byte</span>[] decodedData = CertificateCoder.decryptByPublicKey(encodedData,
                certificatePath);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);

        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&quot;</span>);
        <span class="hljs-comment">// &#x4EA7;&#x751F;&#x7B7E;&#x540D;</span>
        String sign = CertificateCoder.sign(encodedData, keyStorePath, alias,
                password);
        System.err.println(<span class="hljs-string">&quot;&#x7B7E;&#x540D;:\r&quot;</span> + sign);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;</span>
        <span class="hljs-keyword">boolean</span> status = CertificateCoder.verify(encodedData, sign,
                certificatePath);
        System.err.println(<span class="hljs-string">&quot;&#x72B6;&#x6001;:\r&quot;</span> + status);
        assertTrue(status);

    }
}
</code></pre>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;
&#x52A0;&#x5BC6;&#x524D;: Ceritificate

&#x89E3;&#x5BC6;&#x540E;: Ceritificate

&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;
&#x52A0;&#x5BC6;&#x524D;: sign

&#x89E3;&#x5BC6;&#x540E;: sign
&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;
&#x7B7E;&#x540D;:
pqBn5m6PJlfOjH0A6U2o2mUmBsfgyEY1NWCbiyA/I5Gc3gaVNVIdj/zkGNZRqTjhf3+J9a9z9EI7
6F2eWYd7punHx5oh6hfNgcKbVb52EfItl4QEN+djbXiPynn07+Lbg1NOjULnpEd6ZhLP1YwrEAuM
OfvX0e7/wplxLbySaKQ=

&#x72B6;&#x6001;:
true
</code></pre><p>&#x7531;&#x6B64;&#x5B8C;&#x6210;&#x4E86;&#x8BC1;&#x4E66;&#x9A8C;&#x8BC1;&#x4F53;&#x7CFB;&#xFF01; </p>
<p>&#x540C;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5BF9;&#x4EE3;&#x7801;&#x505A;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x4EE3;&#x7801;&#x7B7E;&#x540D;&#xFF01; </p>
<p>&#x901A;&#x8FC7;&#x5DE5;&#x5177;JarSigner&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x4EE3;&#x7801;&#x7B7E;&#x540D;&#x3002; </p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5BF9;tools.jar&#x505A;&#x4EE3;&#x7801;&#x7B7E;&#x540D;&#xFF0C;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>jarsigner -storetype jks -keystore zlex.keystore -verbose tools.jar www.zlex.org
</code></pre><p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;&#x5BC6;&#x94A5;&#x5E93;&#x7684;&#x53E3;&#x4EE4;&#x77ED;&#x8BED;&#xFF1A;
 &#x6B63;&#x5728;&#x66F4;&#x65B0;&#xFF1A; META-INF/WWW_ZLEX.SF
 &#x6B63;&#x5728;&#x66F4;&#x65B0;&#xFF1A; META-INF/WWW_ZLEX.RSA
  &#x6B63;&#x5728;&#x7B7E;&#x540D;&#xFF1A; org/zlex/security/Security.class
  &#x6B63;&#x5728;&#x7B7E;&#x540D;&#xFF1A; org/zlex/tool/Main$1.class
  &#x6B63;&#x5728;&#x7B7E;&#x540D;&#xFF1A; org/zlex/tool/Main$2.class
  &#x6B63;&#x5728;&#x7B7E;&#x540D;&#xFF1A; org/zlex/tool/Main.class

&#x8B66;&#x544A;&#xFF1A;
&#x7B7E;&#x540D;&#x8005;&#x8BC1;&#x4E66;&#x5C06;&#x5728;&#x516D;&#x4E2A;&#x6708;&#x5185;&#x8FC7;&#x671F;&#x3002;
</code></pre><p>&#x6B64;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5BF9;&#x7B7E;&#x540D;&#x540E;&#x7684;jar&#x505A;&#x9A8C;&#x8BC1;&#xFF01; 
&#x9A8C;&#x8BC1;tools.jar&#xFF0C;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>jarsigner -verify -verbose -certs tools.jar
</code></pre><p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>         402 Sat Jun 20 16:25:14 CST 2009 META-INF/MANIFEST.MF
         532 Sat Jun 20 16:25:14 CST 2009 META-INF/WWW_ZLEX.SF
         889 Sat Jun 20 16:25:14 CST 2009 META-INF/WWW_ZLEX.RSA
sm       590 Wed Dec 10 13:03:42 CST 2008 org/zlex/security/Security.class

      X.509, CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
      [&#x8BC1;&#x4E66;&#x5C06;&#x5728; 09-9-18 &#x4E0B;&#x5348;3:27 &#x5230;&#x671F;]

sm       705 Tue Dec 16 18:00:56 CST 2008 org/zlex/tool/Main$1.class

      X.509, CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
      [&#x8BC1;&#x4E66;&#x5C06;&#x5728; 09-9-18 &#x4E0B;&#x5348;3:27 &#x5230;&#x671F;]

sm       779 Tue Dec 16 18:00:56 CST 2008 org/zlex/tool/Main$2.class

      X.509, CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
      [&#x8BC1;&#x4E66;&#x5C06;&#x5728; 09-9-18 &#x4E0B;&#x5348;3:27 &#x5230;&#x671F;]

sm     12672 Tue Dec 16 18:00:56 CST 2008 org/zlex/tool/Main.class

      X.509, CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
      [&#x8BC1;&#x4E66;&#x5C06;&#x5728; 09-9-18 &#x4E0B;&#x5348;3:27 &#x5230;&#x671F;]


  s = &#x5DF2;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;
  m = &#x5728;&#x6E05;&#x5355;&#x4E2D;&#x5217;&#x51FA;&#x6761;&#x76EE;
  k = &#x5728;&#x5BC6;&#x94A5;&#x5E93;&#x4E2D;&#x81F3;&#x5C11;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x8BC1;&#x4E66;
  i = &#x5728;&#x8EAB;&#x4EFD;&#x4F5C;&#x7528;&#x57DF;&#x5185;&#x81F3;&#x5C11;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x8BC1;&#x4E66;

jar &#x5DF2;&#x9A8C;&#x8BC1;&#x3002;

&#x8B66;&#x544A;&#xFF1A;
&#x6B64; jar &#x5305;&#x542B;&#x7B7E;&#x540D;&#x8005;&#x8BC1;&#x4E66;&#x5C06;&#x5728;&#x516D;&#x4E2A;&#x6708;&#x5185;&#x8FC7;&#x671F;&#x7684;&#x6761;&#x76EE;&#x3002;
</code></pre><p>&#x4EE3;&#x7801;&#x7B7E;&#x540D;&#x8BA4;&#x8BC1;&#x7684;&#x7528;&#x9014;&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x53D1;&#x5E03;&#x7684;&#x8F6F;&#x4EF6;&#x505A;&#x9A8C;&#x8BC1;&#xFF0C;&#x652F;&#x6301; Sun Java .jar (Java Applet) &#x6587;&#x4EF6;(J2SE)&#x548C; J2ME MIDlet Suite &#x6587;&#x4EF6;&#x3002; </p>
<p>&#x5728;&#x4E0A;&#x6587;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x6A21;&#x62DF;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;RSA&#x975E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7F51;&#x7EDC;&#x7684;&#x5B89;&#x5168;&#x901A;&#x4FE1;&#x3002;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6DF1;&#x5EA6;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#x73B0;&#x6709;&#x7684;&#x5B89;&#x5168;&#x7F51;&#x7EDC;&#x901A;&#x4FE1;&#x2014;&#x2014;SSL&#x3002; </p>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x7531;CA&#x673A;&#x6784;&#x7B7E;&#x53D1;&#x7684;&#x6709;&#x6548;&#x8BC1;&#x4E66;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E0A;&#x6587;&#x4E2D;&#x751F;&#x6210;&#x7684;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;zlex.cer 
&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BC1;&#x4E66;&#x5BFC;&#x5165;&#x5230;&#x6211;&#x4EEC;&#x7684;&#x5BC6;&#x94A5;&#x5E93;&#x3002; </p>
<pre><code>keytool -import -alias www.zlex.org -file d:/zlex.cer -keystore d:/zlex.keystore
</code></pre><p>&#x5176;&#x4E2D; </p>
<p>-import&#x8868;&#x793A;&#x5BFC;&#x5165; 
-alias&#x6307;&#x5B9A;&#x522B;&#x540D;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;www.zlex.org 
-file&#x6307;&#x5B9A;&#x7B97;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;d:/zlex.cer 
-keystore&#x6307;&#x5B9A;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;d:/zlex.keystore </p>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x7684;&#x5BC6;&#x7801;&#x4E3A;654321 </p>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;keystore&#x5BC6;&#x7801;&#xFF1A;
&#x518D;&#x6B21;&#x8F93;&#x5165;&#x65B0;&#x5BC6;&#x7801;:
&#x6240;&#x6709;&#x8005;:CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
&#x7B7E;&#x53D1;&#x4EBA;:CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN
&#x5E8F;&#x5217;&#x53F7;:4a1e48df
&#x6709;&#x6548;&#x671F;: Thu May 28 16:18:39 CST 2009 &#x81F3;Wed Aug 26 16:18:39 CST 2009
&#x8BC1;&#x4E66;&#x6307;&#x7EB9;:
        MD5:19:CA:E6:36:E2:DF:AD:96:31:97:2F:A9:AD:FC:37:6A
        SHA1:49:88:30:59:29:45:F1:69:CA:97:A9:6D:8A:CF:08:D2:C3:D5:C0:C4
        &#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#x540D;&#x79F0;:SHA1withRSA
        &#x7248;&#x672C;: 3
&#x4FE1;&#x4EFB;&#x8FD9;&#x4E2A;&#x8BA4;&#x8BC1;&#xFF1F; [&#x5426;]&#xFF1A;  y
&#x8BA4;&#x8BC1;&#x5DF2;&#x6DFB;&#x52A0;&#x81F3;keystore&#x4E2D;
</code></pre><p>OK&#xFF0C;&#x6700;&#x590D;&#x6742;&#x7684;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x3002; 
&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5C06;&#x57DF;&#x540D;<code>www.zlex.org</code>&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#x4E0A;&#x3002;</p>
<p>&#x6253;&#x5F00;<code>C:\Windows\System32\drivers\etc\hosts</code>&#x6587;&#x4EF6;&#xFF0C;&#x5C06;<code>www.zlex.org</code>&#x7ED1;&#x5B9A;&#x5728;&#x672C;&#x673A;&#x4E0A;&#x3002;</p>
<p>&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x8FFD;&#x52A0; <code>127.0.0.1       www.zlex.org</code>&#x3002;</p>
<p>&#x73B0;&#x5728;&#x901A;&#x8FC7;&#x5730;&#x5740;&#x680F;&#x8BBF;&#x95EE; <a href="http://www.zlex.org&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;ping&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#xFF0C;&#x57DF;&#x540D;&#x6620;&#x5C04;&#x5C31;&#x641E;&#x5B9A;&#x4E86;&#x3002;" target="_blank">http://www.zlex.org&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;ping&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#xFF0C;&#x57DF;&#x540D;&#x6620;&#x5C04;&#x5C31;&#x641E;&#x5B9A;&#x4E86;&#x3002;</a> 
&#x73B0;&#x5728;&#xFF0C;&#x914D;&#x7F6E;tomcat&#x3002;&#x5148;&#x5C06;zlex.keystore&#x62F7;&#x8D1D;&#x5230;tomcat&#x7684;conf&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x914D;&#x7F6E;<code>server.xml</code>&#x3002;&#x5C06;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#x52A0;&#x5165;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span>
        <span class="hljs-attr">SSLEnabled</span>=<span class="hljs-string">&quot;true&quot;</span>
        <span class="hljs-attr">URIEncoding</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>
        <span class="hljs-attr">clientAuth</span>=<span class="hljs-string">&quot;false&quot;</span>
        <span class="hljs-attr">keystoreFile</span>=<span class="hljs-string">&quot;conf/zlex.keystore&quot;</span>
        <span class="hljs-attr">keystorePass</span>=<span class="hljs-string">&quot;123456&quot;</span>
        <span class="hljs-attr">maxThreads</span>=<span class="hljs-string">&quot;150&quot;</span>
        <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;443&quot;</span>
        <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;HTTP/1.1&quot;</span>
        <span class="hljs-attr">scheme</span>=<span class="hljs-string">&quot;https&quot;</span>
        <span class="hljs-attr">secure</span>=<span class="hljs-string">&quot;true&quot;</span>
        <span class="hljs-attr">sslProtocol</span>=<span class="hljs-string">&quot;TLS&quot;</span> /&gt;</span>
</code></pre>
<p>&#x6CE8;&#x610F;clientAuth=&quot;false&quot;&#x6D4B;&#x8BD5;&#x9636;&#x6BB5;&#xFF0C;&#x7F6E;&#x4E3A;false&#xFF0C;&#x6B63;&#x5F0F;&#x4F7F;&#x7528;&#x65F6;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;true&#x3002;&#x73B0;&#x5728;&#x542F;&#x52A8;tomcat&#xFF0C;&#x8BBF;&#x95EE;<a href="https://www.zlex.org/&#x3002;" target="_blank">https://www.zlex.org/&#x3002;</a> <img src="images/ca-001.jpg" alt="&#x8BC1;&#x4E66;&#x5931;&#x6548;"></p>
<p>&#x663E;&#x7136;&#xFF0C;&#x8BC1;&#x4E66;&#x672A;&#x80FD;&#x901A;&#x8FC7;&#x8BA4;&#x8BC1;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F60;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5B89;&#x88C5;&#x8BC1;&#x4E66;&#xFF08;&#x4E0A;&#x6587;&#x4E2D;&#x7684;zlex.cer&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x8BC1;&#x4E66;&#xFF09;&#xFF0C;&#x4F5C;&#x4E3A;&#x53D7;&#x4FE1;&#x4EFB;&#x7684;&#x6839;&#x8BC1;&#x4E66;&#x9881;&#x53D1;&#x673A;&#x6784;&#x5BFC;&#x5165;&#xFF0C;&#x518D;&#x6B21;&#x91CD;&#x542F;&#x6D4F;&#x89C8;&#x5668;&#xFF08;IE&#xFF0C;&#x5176;&#x4ED6;&#x6D4F;&#x89C8;&#x5668;&#x5BF9;&#x4E8E;&#x57DF;&#x540D;www.zlex.org&#x4E0D;&#x652F;&#x6301;&#x672C;&#x5730;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#xFF09;&#xFF0C;&#x8BBF;&#x95EE;<a href="https://www.zlex.org/&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5730;&#x5740;&#x680F;&#x4E2D;&#x4F1A;&#x6709;&#x4E2A;&#x5C0F;&#x9501;" target="_blank">https://www.zlex.org/&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x5730;&#x5740;&#x680F;&#x4E2D;&#x4F1A;&#x6709;&#x4E2A;&#x5C0F;&#x9501;</a> <img src="images/ca-002.jpg" alt=""> &#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x5B89;&#x88C5;&#x6210;&#x529F;&#x3002;&#x6240;&#x6709;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x8054;&#x7F51;&#x64CD;&#x4F5C;&#x5DF2;&#x7ECF;&#x5728;RSA&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x7CFB;&#x7EDF;&#x7684;&#x4FDD;&#x62A4;&#x4E4B;&#x4E0B;&#x4E86;&#x3002;&#x4F46;&#x4F3C;&#x4E4E;&#x6211;&#x4EEC;&#x611F;&#x53D7;&#x4E0D;&#x5230;&#x3002; </p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5F88;&#x591A;&#x4EBA;&#x5F00;&#x59CB;&#x6000;&#x7591;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x624B;&#x5DE5;&#x505A;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;https&#x7684;&#x8BBF;&#x95EE;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x628A;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x8FD9;&#x4E9B;&#x4E2A;&#x529F;&#x80FD;&#x90FD;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;&#x4E0D;&#x9700;&#x8981;&#xFF01; </p>
<p><strong>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5F88;&#x591A;&#x4EBA;&#x5F00;&#x59CB;&#x6000;&#x7591;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x624B;&#x5DE5;&#x505A;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;https&#x7684;&#x8BBF;&#x95EE;&#x662F;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x628A;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x8FD9;&#x4E9B;&#x4E2A;&#x529F;&#x80FD;&#x90FD;&#x5B9E;&#x73B0;&#x5462;&#xFF1F;&#x4E0D;&#x9700;&#x8981;&#xFF01;</strong></p>
<p>&#x63A5;&#x7740;&#x4E0A;&#x7BC7;&#x5185;&#x5BB9;&#xFF0C;&#x7ED9;&#x51FA;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.io.FileInputStream;
<span class="hljs-keyword">import</span> java.security.KeyStore;
<span class="hljs-keyword">import</span> java.security.PrivateKey;
<span class="hljs-keyword">import</span> java.security.PublicKey;
<span class="hljs-keyword">import</span> java.security.Signature;
<span class="hljs-keyword">import</span> java.security.cert.Certificate;
<span class="hljs-keyword">import</span> java.security.cert.CertificateFactory;
<span class="hljs-keyword">import</span> java.security.cert.X509Certificate;
<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-keyword">import</span> javax.crypto.Cipher;
<span class="hljs-keyword">import</span> javax.net.ssl.HttpsURLConnection;
<span class="hljs-keyword">import</span> javax.net.ssl.KeyManagerFactory;
<span class="hljs-keyword">import</span> javax.net.ssl.SSLContext;
<span class="hljs-keyword">import</span> javax.net.ssl.SSLSocketFactory;
<span class="hljs-keyword">import</span> javax.net.ssl.TrustManagerFactory;

<span class="hljs-comment">/**
 * &#x8BC1;&#x4E66;&#x7EC4;&#x4EF6;
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateCoder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coder</span> </span>{

    <span class="hljs-comment">/**
     * Java&#x5BC6;&#x94A5;&#x5E93;(Java Key Store&#xFF0C;JKS)KEY_STORE
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String KEY_STORE = <span class="hljs-string">&quot;JKS&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String X509 = <span class="hljs-string">&quot;X.509&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SunX509 = <span class="hljs-string">&quot;SunX509&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SSL = <span class="hljs-string">&quot;SSL&quot;</span>;

    <span class="hljs-comment">/**
     * &#x7531;KeyStore&#x83B7;&#x5F97;&#x79C1;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PrivateKey <span class="hljs-title">getPrivateKey</span><span class="hljs-params">(String keyStorePath, String alias,
            String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyStore ks = getKeyStore(keyStorePath, password);
        PrivateKey key = (PrivateKey) ks.getKey(alias, password.toCharArray());
        <span class="hljs-keyword">return</span> key;
    }

    <span class="hljs-comment">/**
     * &#x7531;Certificate&#x83B7;&#x5F97;&#x516C;&#x94A5;
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PublicKey <span class="hljs-title">getPublicKey</span><span class="hljs-params">(String certificatePath)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        Certificate certificate = getCertificate(certificatePath);
        PublicKey key = certificate.getPublicKey();
        <span class="hljs-keyword">return</span> key;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;Certificate
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Certificate <span class="hljs-title">getCertificate</span><span class="hljs-params">(String certificatePath)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        CertificateFactory certificateFactory = CertificateFactory
                .getInstance(X509);
        FileInputStream in = <span class="hljs-keyword">new</span> FileInputStream(certificatePath);

        Certificate certificate = certificateFactory.generateCertificate(in);
        in.close();

        <span class="hljs-keyword">return</span> certificate;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Certificate <span class="hljs-title">getCertificate</span><span class="hljs-params">(String keyStorePath,
            String alias, String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        KeyStore ks = getKeyStore(keyStorePath, password);
        Certificate certificate = ks.getCertificate(alias);

        <span class="hljs-keyword">return</span> certificate;
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;KeyStore
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> KeyStore <span class="hljs-title">getKeyStore</span><span class="hljs-params">(String keyStorePath, String password)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        FileInputStream is = <span class="hljs-keyword">new</span> FileInputStream(keyStorePath);
        KeyStore ks = KeyStore.getInstance(KEY_STORE);
        ks.load(is, password.toCharArray());
        is.close();
        <span class="hljs-keyword">return</span> ks;
    }

    <span class="hljs-comment">/**
     * &#x79C1;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String keyStorePath,
            String alias, String password) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = getPrivateKey(keyStorePath, alias, password);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(privateKey.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x79C1;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPrivateKey(<span class="hljs-keyword">byte</span>[] data, String keyStorePath,
            String alias, String password) <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = getPrivateKey(keyStorePath, alias, password);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(privateKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, privateKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x516C;&#x94A5;&#x52A0;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] encryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String certificatePath)
            <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = getPublicKey(certificatePath);
        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(publicKey.getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x516C;&#x94A5;&#x89E3;&#x5BC6;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] decryptByPublicKey(<span class="hljs-keyword">byte</span>[] data, String certificatePath)
            <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = getPublicKey(certificatePath);

        <span class="hljs-comment">// &#x5BF9;&#x6570;&#x636E;&#x52A0;&#x5BC6;</span>
        Cipher cipher = Cipher.getInstance(publicKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, publicKey);

        <span class="hljs-keyword">return</span> cipher.doFinal(data);

    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(String certificatePath)</span> </span>{
        <span class="hljs-keyword">return</span> verifyCertificate(<span class="hljs-keyword">new</span> Date(), certificatePath);
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;
     * 
     * <span class="hljs-doctag">@param</span> date
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, String certificatePath)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// &#x53D6;&#x5F97;&#x8BC1;&#x4E66;</span>
            Certificate certificate = getCertificate(certificatePath);
            <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;</span>
            status = verifyCertificate(date, certificate);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x662F;&#x5426;&#x8FC7;&#x671F;&#x6216;&#x65E0;&#x6548;
     * 
     * <span class="hljs-doctag">@param</span> date
     * <span class="hljs-doctag">@param</span> certificate
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, Certificate certificate)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            X509Certificate x509Certificate = (X509Certificate) certificate;
            x509Certificate.checkValidity(date);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * 
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">sign</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] sign, String keyStorePath, String alias,
            String password)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x8BC1;&#x4E66;</span>
        X509Certificate x509Certificate = (X509Certificate) getCertificate(
                keyStorePath, alias, password);
        <span class="hljs-comment">// &#x83B7;&#x53D6;&#x79C1;&#x94A5;</span>
        KeyStore ks = getKeyStore(keyStorePath, password);
        <span class="hljs-comment">// &#x53D6;&#x5F97;&#x79C1;&#x94A5;</span>
        PrivateKey privateKey = (PrivateKey) ks.getKey(alias, password
                .toCharArray());

        <span class="hljs-comment">// &#x6784;&#x5EFA;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(x509Certificate
                .getSigAlgName());
        signature.initSign(privateKey);
        signature.update(sign);
        <span class="hljs-keyword">return</span> encryptBASE64(signature.sign());
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;
     * 
     * <span class="hljs-doctag">@param</span> data
     * <span class="hljs-doctag">@param</span> sign
     * <span class="hljs-doctag">@param</span> certificatePath
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verify</span><span class="hljs-params">(<span class="hljs-keyword">byte</span>[] data, String sign,
            String certificatePath)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x8BC1;&#x4E66;</span>
        X509Certificate x509Certificate = (X509Certificate) getCertificate(certificatePath);
        <span class="hljs-comment">// &#x83B7;&#x5F97;&#x516C;&#x94A5;</span>
        PublicKey publicKey = x509Certificate.getPublicKey();
        <span class="hljs-comment">// &#x6784;&#x5EFA;&#x7B7E;&#x540D;</span>
        Signature signature = Signature.getInstance(x509Certificate
                .getSigAlgName());
        signature.initVerify(publicKey);
        signature.update(data);

        <span class="hljs-keyword">return</span> signature.verify(decryptBASE64(sign));

    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(Date date, String keyStorePath,
            String alias, String password)</span> </span>{
        <span class="hljs-keyword">boolean</span> status = <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">try</span> {
            Certificate certificate = getCertificate(keyStorePath, alias,
                    password);
            status = verifyCertificate(date, certificate);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            status = <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">/**
     * &#x9A8C;&#x8BC1;Certificate
     * 
     * <span class="hljs-doctag">@param</span> keyStorePath
     * <span class="hljs-doctag">@param</span> alias
     * <span class="hljs-doctag">@param</span> password
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyCertificate</span><span class="hljs-params">(String keyStorePath, String alias,
            String password)</span> </span>{
        <span class="hljs-keyword">return</span> verifyCertificate(<span class="hljs-keyword">new</span> Date(), keyStorePath, alias, password);
    }

    <span class="hljs-comment">/**
     * &#x83B7;&#x5F97;SSLSocektFactory
     * 
     * <span class="hljs-doctag">@param</span> password
     *            &#x5BC6;&#x7801;
     * <span class="hljs-doctag">@param</span> keyStorePath
     *            &#x5BC6;&#x94A5;&#x5E93;&#x8DEF;&#x5F84;
     * 
     * <span class="hljs-doctag">@param</span> trustKeyStorePath
     *            &#x4FE1;&#x4EFB;&#x5E93;&#x8DEF;&#x5F84;
     * <span class="hljs-doctag">@return</span>
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SSLSocketFactory <span class="hljs-title">getSSLSocketFactory</span><span class="hljs-params">(String password,
            String keyStorePath, String trustKeyStorePath)</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x5BC6;&#x94A5;&#x5E93;</span>
        KeyManagerFactory keyManagerFactory = KeyManagerFactory
                .getInstance(SunX509);
        KeyStore keyStore = getKeyStore(keyStorePath, password);
        keyManagerFactory.init(keyStore, password.toCharArray());

        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x4FE1;&#x4EFB;&#x5E93;</span>
        TrustManagerFactory trustManagerFactory = TrustManagerFactory
                .getInstance(SunX509);
        KeyStore trustkeyStore = getKeyStore(trustKeyStorePath, password);
        trustManagerFactory.init(trustkeyStore);

        <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;SSL&#x4E0A;&#x4E0B;&#x6587;</span>
        SSLContext ctx = SSLContext.getInstance(SSL);
        ctx.init(keyManagerFactory.getKeyManagers(), trustManagerFactory
                .getTrustManagers(), <span class="hljs-keyword">null</span>);
        SSLSocketFactory sf = ctx.getSocketFactory();

        <span class="hljs-keyword">return</span> sf;
    }

    <span class="hljs-comment">/**
     * &#x4E3A;HttpsURLConnection&#x914D;&#x7F6E;SSLSocketFactory
     * 
     * <span class="hljs-doctag">@param</span> conn
     *            HttpsURLConnection
     * <span class="hljs-doctag">@param</span> password
     *            &#x5BC6;&#x7801;
     * <span class="hljs-doctag">@param</span> keyStorePath
     *            &#x5BC6;&#x94A5;&#x5E93;&#x8DEF;&#x5F84;
     * 
     * <span class="hljs-doctag">@param</span> trustKeyStorePath
     *            &#x4FE1;&#x4EFB;&#x5E93;&#x8DEF;&#x5F84;
     * <span class="hljs-doctag">@throws</span> Exception
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configSSLSocketFactory</span><span class="hljs-params">(HttpsURLConnection conn,
            String password, String keyStorePath, String trustKeyStorePath)</span>
            <span class="hljs-keyword">throws</span> Exception </span>{
        conn.setSSLSocketFactory(getSSLSocketFactory(password, keyStorePath,
                trustKeyStorePath));
    }
}
</code></pre>
<p>&#x589E;&#x52A0;&#x4E86;<code>configSSLSocketFactory</code>&#x65B9;&#x6CD5;&#x4F9B;&#x5916;&#x754C;&#x8C03;&#x7528;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4E3A; <code>HttpsURLConnection</code>&#x914D;&#x7F6E;&#x4E86;<code>SSLSocketFactory</code>&#x3002;&#x5F53; <code>HttpsURLConnection</code> &#x914D;&#x7F6E;&#x4E86; <code>SSLSocketFactory</code>&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; <code>HttpsURLConnection&#x7684;getInputStream</code>&#x3001; <code>getOutputStream</code>&#xFF0C;&#x50CF;&#x5F80;&#x5E38;&#x4F7F;&#x7528; <code>HttpURLConnection</code> &#x505A;&#x64CD;&#x4F5C;&#x4E86;&#x3002;&#x5C24;&#x5176;&#x8981;&#x8BF4;&#x660E;&#x4E00;&#x70B9;&#xFF0C;&#x672A;&#x914D;&#x7F6E; <code>SSLSocketFactory</code> &#x524D;&#xFF0C;<code>HttpsURLConnection</code>&#x7684;<code>getContentLength()</code>&#x83B7;&#x5F97;&#x503C;&#x6C38;&#x8FDC;&#x90FD;&#x662F;-1&#x3002; </p>
<p>&#x7ED9;&#x51FA;&#x76F8;&#x5E94;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> java.io.DataInputStream;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.net.URL;

<span class="hljs-keyword">import</span> javax.net.ssl.HttpsURLConnection;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateCoderTest</span> </span>{
    <span class="hljs-keyword">private</span> String password = <span class="hljs-string">&quot;123456&quot;</span>;
    <span class="hljs-keyword">private</span> String alias = <span class="hljs-string">&quot;www.zlex.org&quot;</span>;
    <span class="hljs-keyword">private</span> String certificatePath = <span class="hljs-string">&quot;d:/zlex.cer&quot;</span>;
    <span class="hljs-keyword">private</span> String keyStorePath = <span class="hljs-string">&quot;d:/zlex.keystore&quot;</span>;
    <span class="hljs-keyword">private</span> String clientKeyStorePath = <span class="hljs-string">&quot;d:/zlex-client.keystore&quot;</span>;
    <span class="hljs-keyword">private</span> String clientPassword = <span class="hljs-string">&quot;654321&quot;</span>;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);
        String inputStr = <span class="hljs-string">&quot;Ceritifcate&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encrypt = CertificateCoder.encryptByPublicKey(data,
                certificatePath);

        <span class="hljs-keyword">byte</span>[] decrypt = CertificateCoder.decryptByPrivateKey(encrypt,
                keyStorePath, alias, password);
        String outputStr = <span class="hljs-keyword">new</span> String(decrypt);

        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x6570;&#x636E;&#x4E00;&#x81F4;</span>
        assertArrayEquals(data, decrypt);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x6709;&#x6548;</span>
        assertTrue(CertificateCoder.verifyCertificate(certificatePath));

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSign</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);

        String inputStr = <span class="hljs-string">&quot;sign&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encodedData = CertificateCoder.encryptByPrivateKey(data,
                keyStorePath, alias, password);

        <span class="hljs-keyword">byte</span>[] decodedData = CertificateCoder.decryptByPublicKey(encodedData,
                certificatePath);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);

        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&quot;</span>);
        <span class="hljs-comment">// &#x4EA7;&#x751F;&#x7B7E;&#x540D;</span>
        String sign = CertificateCoder.sign(encodedData, keyStorePath, alias,
                password);
        System.err.println(<span class="hljs-string">&quot;&#x7B7E;&#x540D;:\r&quot;</span> + sign);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;</span>
        <span class="hljs-keyword">boolean</span> status = CertificateCoder.verify(encodedData, sign,
                certificatePath);
        System.err.println(<span class="hljs-string">&quot;&#x72B6;&#x6001;:\r&quot;</span> + status);
        assertTrue(status);

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHttps</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        URL url = <span class="hljs-keyword">new</span> URL(<span class="hljs-string">&quot;https://www.zlex.org/examples/&quot;</span>);
        HttpsURLConnection conn = (HttpsURLConnection) url.openConnection();

        conn.setDoInput(<span class="hljs-keyword">true</span>);
        conn.setDoOutput(<span class="hljs-keyword">true</span>);

        CertificateCoder.configSSLSocketFactory(conn, clientPassword,
                clientKeyStorePath, clientKeyStorePath);

        InputStream is = conn.getInputStream();

        <span class="hljs-keyword">int</span> length = conn.getContentLength();

        DataInputStream dis = <span class="hljs-keyword">new</span> DataInputStream(is);
        <span class="hljs-keyword">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[length];
        dis.readFully(data);

        dis.close();
        System.err.println(<span class="hljs-keyword">new</span> String(data));
        conn.disconnect();
    }
}
</code></pre>
<p>&#x6CE8;&#x610F;testHttps&#x65B9;&#x6CD5;&#xFF0C;&#x51E0;&#x4E4E;&#x548C;&#x6211;&#x4EEC;&#x5F80;&#x5E38;&#x505A;HTTP&#x8BBF;&#x95EE;&#x6CA1;&#x6709;&#x5DEE;&#x522B;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &quot;License&quot;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">HTML</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">HEAD</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">TITLE</span>&gt;</span>Apache Tomcat Examples<span class="hljs-tag">&lt;/<span class="hljs-name">TITLE</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">META</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">Content-Type</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">HEAD</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">BODY</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">P</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">H3</span>&gt;</span>Apache Tomcat Examples<span class="hljs-tag">&lt;/<span class="hljs-name">H3</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">P</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">P</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://javaeye.shaduwang.com/?snowolf/blog/servlets&quot;</span>&gt;</span>Servlets examples<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://javaeye.shaduwang.com/?snowolf/blog/jsp&quot;</span>&gt;</span>JSP Examples<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">BODY</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">HTML</span>&gt;</span>
</code></pre>
<p>&#x901A;&#x8FC7;&#x6D4F;&#x89C8;&#x5668;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;<a href="https://www.zlex.org/examples/&#x4F60;" target="_blank">https://www.zlex.org/examples/&#x4F60;</a> &#x4E5F;&#x4F1A;&#x83B7;&#x5F97;&#x4E0A;&#x8FF0;&#x5185;&#x5BB9;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5E94;&#x7528;&#x7532;&#x65B9;&#x4F5C;&#x4E3A;&#x670D;&#x52A1;&#x5668;&#x6784;&#x5EFA;tomcat&#x670D;&#x52A1;&#xFF0C;&#x4E59;&#x65B9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0A;&#x8FF0;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#x7532;&#x65B9;&#x53D7;&#x4FDD;&#x62A4;&#x7684;SSL&#x5E94;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x9700;&#x8981;&#x8003;&#x8651;&#x5177;&#x4F53;&#x7684;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x95EE; &#x9898;&#x3002;&#x7532;&#x4E59;&#x53CC;&#x65B9;&#x53EF;&#x4EE5;&#x7ECF;&#x8FC7;&#x76F8;&#x5E94;&#x914D;&#x7F6E;&#xFF0C;&#x901A;&#x8FC7;&#x53CC;&#x65B9;&#x7684;tomcat&#x914D;&#x7F6E;&#x6709;&#x6548;&#x7684;SSL&#x670D;&#x52A1;&#xFF0C;&#x7B80;&#x5316;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF0C;&#x5B8C;&#x5168;&#x901A;&#x8FC7;&#x8BC1;&#x4E66;&#x914D;&#x7F6E;&#x5B8C;&#x6210;SSL&#x53CC;&#x5411;&#x8BA4;&#x8BC1;&#xFF01;</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;&#x5B8C;&#x6210;&#x4E86;&#x8BA4;&#x8BC1;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7B2C;&#x4E09;&#x65B9;CA&#x7B7E;&#x540D;&#x673A;&#x6784;&#x5B8C;&#x6210;&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#x3002; 
&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;thawte&#x63D0;&#x4F9B;&#x7684;&#x6D4B;&#x8BD5;&#x7528;21&#x5929;&#x514D;&#x8D39;ca&#x8BC1;&#x4E66;&#x3002; </p>
<ol>
<li>&#x8981;&#x5728;&#x8BE5;&#x7F51;&#x7AD9;&#x4E0A;&#x6CE8;&#x660E;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;www.zlex.org&#x4F5C;&#x4E3A;&#x6D4B;&#x8BD5;&#x7528;&#x57DF;&#x540D;&#xFF08;<strong>&#x8BF7;&#x52FF;&#x4F7F;&#x7528;&#x8BE5;&#x57DF;&#x540D;&#x4F5C;&#x4E3A;&#x4F60;&#x7684;&#x57DF;&#x540D;&#x5730;&#x5740;&#xFF0C;&#x8BE5;&#x57DF;&#x540D;&#x53D7;&#x6CD5;&#x5F8B;&#x4FDD;&#x62A4;&#xFF01;&#x8BF7;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x975E;&#x6CE8;&#x518C;&#x57DF;&#x540D;&#xFF01;</strong>&#xFF09;&#x3002; </li>
<li>&#x5982;&#x679C;&#x57DF;&#x540D;&#x6709;&#x6548;&#xFF0C;&#x4F60;&#x4F1A;&#x6536;&#x5230;&#x90AE;&#x4EF6;&#x8981;&#x6C42;&#x4F60;&#x8BBF;&#x95EE;<a href="https://www.thawte.com/cgi/server/try.exe&#x83B7;&#x5F97;ca&#x8BC1;&#x4E66;&#x3002;" target="_blank">https://www.thawte.com/cgi/server/try.exe&#x83B7;&#x5F97;ca&#x8BC1;&#x4E66;&#x3002;</a> </li>
<li><p>&#x590D;&#x8FF0;&#x5BC6;&#x94A5;&#x5E93;&#x7684;&#x521B;&#x5EFA;&#x3002;</p>
<p> keytool -genkey -validity 36000 -alias www.zlex.org -keyalg RSA -keystore d:\zlex.keystore</p>
</li>
</ol>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x7684;&#x5BC6;&#x7801;&#x4E3A; 123456 </p>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;keystore&#x5BC6;&#x7801;&#xFF1A;
&#x518D;&#x6B21;&#x8F93;&#x5165;&#x65B0;&#x5BC6;&#x7801;:
&#x60A8;&#x7684;&#x540D;&#x5B57;&#x4E0E;&#x59D3;&#x6C0F;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
[Unknown]&#xFF1A;  www.zlex.org
&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x5355;&#x4F4D;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
[Unknown]&#xFF1A;  zlex
&#x60A8;&#x7684;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
[Unknown]&#xFF1A;  zlex
&#x60A8;&#x6240;&#x5728;&#x7684;&#x57CE;&#x5E02;&#x6216;&#x533A;&#x57DF;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
[Unknown]&#xFF1A;  BJ
&#x60A8;&#x6240;&#x5728;&#x7684;&#x5DDE;&#x6216;&#x7701;&#x4EFD;&#x540D;&#x79F0;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;
[Unknown]&#xFF1A;  BJ
&#x8BE5;&#x5355;&#x4F4D;&#x7684;&#x4E24;&#x5B57;&#x6BCD;&#x56FD;&#x5BB6;&#x4EE3;&#x7801;&#x662F;&#x4EC0;&#x4E48;
[Unknown]&#xFF1A;  CN
CN=www.zlex.org, OU=zlex, O=zlex, L=BJ, ST=BJ, C=CN &#x6B63;&#x786E;&#x5417;&#xFF1F;
[&#x5426;]&#xFF1A;  Y

&#x8F93;&#x5165;&lt;tomcat&gt;&#x7684;&#x4E3B;&#x5BC6;&#x7801;
        &#xFF08;&#x5982;&#x679C;&#x548C; keystore &#x5BC6;&#x7801;&#x76F8;&#x540C;&#xFF0C;&#x6309;&#x56DE;&#x8F66;&#xFF09;&#xFF1A;
&#x518D;&#x6B21;&#x8F93;&#x5165;&#x65B0;&#x5BC6;&#x7801;:
</code></pre><ol>
<li><p>&#x901A;&#x8FC7;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#xFF0C;&#x4ECE;zlex.keystore&#x4E2D;&#x5BFC;&#x51FA;CA&#x8BC1;&#x4E66;&#x7533;&#x8BF7;&#x3002; </p>
<p> keytool -certreq -alias www.zlex.org -file d:\zlex.csr -keystore d:\zlex.keystore -v</p>
</li>
</ol>
<p>&#x4F60;&#x4F1A;&#x83B7;&#x5F97;zlex.csr&#x6587;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x8BB0;&#x4E8B;&#x672C;&#x6253;&#x5F00;&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#x683C;&#x5F0F;&#xFF1A;</p>
<pre><code>-----BEGIN NEW CERTIFICATE REQUEST-----
MIIBnDCCAQUCAQAwXDELMAkGA1UEBhMCQ04xCzAJBgNVBAgTAkJKMQswCQYDVQQHEwJCSjENMAsG
A1UEChMEemxleDENMAsGA1UECxMEemxleDEVMBMGA1UEAxMMd3d3LnpsZXgub3JnMIGfMA0GCSqG
SIb3DQEBAQUAA4GNADCBiQKBgQCR6DXU9Mp+mCKO7cv9JPsj0n1Ec/GpM09qvhpgX3FNad/ZWSDc
vU77YXZSoF9hQp3w1LC+eeKgd2MlVpXTvbVwBNVd2HiQPp37ic6BUUjSaX8LHtCl7l0BIEye9qQ2
j8G0kak7e8ZA0s7nb3Ymq/K8BV7v0MQIdhIc1bifK9ZDewIDAQABoAAwDQYJKoZIhvcNAQEFBQAD
gYEAMA1r2fbZPtNx37U9TRwadCH2TZZecwKJS/hskNm6ryPKIAp9APWwAyj8WJHRBz5SpZM4zmYO
oMCI8BcnY2A4JP+R7/SwXTdH/xcg7NVghd9A2SCgqMpF7KMfc5dE3iygdiPu+UhY200Dvpjx8gmJ
1UbH3+nqMUyCrZgURFslOUY=
-----END NEW CERTIFICATE REQUEST-----
</code></pre><ol>
<li>&#x5C06;&#x4E0A;&#x8FF0;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x62F7;&#x8D1D;&#x5230;<a href="https://www.thawte.com/cgi/server/try.exe&#x4E2D;&#xFF0C;&#x70B9;&#x51FB;next&#xFF0C;&#x83B7;&#x5F97;&#x56DE;&#x5E94;&#x5185;&#x5BB9;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;p7b&#x683C;&#x5F0F;&#x3002;" target="_blank">https://www.thawte.com/cgi/server/try.exe&#x4E2D;&#xFF0C;&#x70B9;&#x51FB;next&#xFF0C;&#x83B7;&#x5F97;&#x56DE;&#x5E94;&#x5185;&#x5BB9;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;p7b&#x683C;&#x5F0F;&#x3002;</a> 
&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</li>
</ol>
<pre><code>-----BEGIN PKCS7-----
MIIF3AYJKoZIhvcNAQcCoIIFzTCCBckCAQExADALBgkqhkiG9w0BBwGgggWxMIID
EDCCAnmgAwIBAgIQA/mx/pKoaB+KGX2hveFU9zANBgkqhkiG9w0BAQUFADCBhzEL
MAkGA1UEBhMCWkExIjAgBgNVBAgTGUZPUiBURVNUSU5HIFBVUlBPU0VTIE9OTFkx
HTAbBgNVBAoTFFRoYXd0ZSBDZXJ0aWZpY2F0aW9uMRcwFQYDVQQLEw5URVNUIFRF
U1QgVEVTVDEcMBoGA1UEAxMTVGhhd3RlIFRlc3QgQ0EgUm9vdDAeFw0wOTA1Mjgw
MDIxMzlaFw0wOTA2MTgwMDIxMzlaMFwxCzAJBgNVBAYTAkNOMQswCQYDVQQIEwJC
SjELMAkGA1UEBxMCQkoxDTALBgNVBAoTBHpsZXgxDTALBgNVBAsTBHpsZXgxFTAT
BgNVBAMTDHd3dy56bGV4Lm9yZzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA
keg11PTKfpgiju3L/ST7I9J9RHPxqTNPar4aYF9xTWnf2Vkg3L1O+2F2UqBfYUKd
8NSwvnnioHdjJVaV0721cATVXdh4kD6d+4nOgVFI0ml/Cx7Qpe5dASBMnvakNo/B
tJGpO3vGQNLO5292JqvyvAVe79DECHYSHNW4nyvWQ3sCAwEAAaOBpjCBozAMBgNV
HRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBABgNVHR8E
OTA3MDWgM6Axhi9odHRwOi8vY3JsLnRoYXd0ZS5jb20vVGhhd3RlUHJlbWl1bVNl
cnZlckNBLmNybDAyBggrBgEFBQcBAQQmMCQwIgYIKwYBBQUHMAGGFmh0dHA6Ly9v
Y3NwLnRoYXd0ZS5jb20wDQYJKoZIhvcNAQEFBQADgYEATPuxZbtJJSPmXvfrr1yz
xqM06IwTZ6UU0lZRG7I0WufMjNMKdpn8hklUhE17mxAhGSpewLVVeLR7uzBLFkuC
X7wMXxhoYdJZtNai72izU6Rd1oknao7diahvRxPK4IuQ7y2oZ511/4T4vgY6iRAj
q4q76HhPJrVRL/sduaiu+gYwggKZMIICAqADAgECAgEAMA0GCSqGSIb3DQEBBAUA
MIGHMQswCQYDVQQGEwJaQTEiMCAGA1UECBMZRk9SIFRFU1RJTkcgUFVSUE9TRVMg
T05MWTEdMBsGA1UEChMUVGhhd3RlIENlcnRpZmljYXRpb24xFzAVBgNVBAsTDlRF
U1QgVEVTVCBURVNUMRwwGgYDVQQDExNUaGF3dGUgVGVzdCBDQSBSb290MB4XDTk2
MDgwMTAwMDAwMFoXDTIwMTIzMTIxNTk1OVowgYcxCzAJBgNVBAYTAlpBMSIwIAYD
VQQIExlGT1IgVEVTVElORyBQVVJQT1NFUyBPTkxZMR0wGwYDVQQKExRUaGF3dGUg
Q2VydGlmaWNhdGlvbjEXMBUGA1UECxMOVEVTVCBURVNUIFRFU1QxHDAaBgNVBAMT
E1RoYXd0ZSBUZXN0IENBIFJvb3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB
ALV9kG+Os6x/DOhm+tKUQfzVMWGhE95sFmEtkMMTX2Zi4n6i6BvzoReJ5njzt1LF
cqu4EUk9Ji20egKKfmqRzmQFLP7+1niSdfJEUE7cKY40QoI99270PTrLjJeaMcCl
+AYl+kD+RL5BtuKKU3PurYcsCsre6aTvjMcqpTJOGeSPAgMBAAGjEzARMA8GA1Ud
EwEB/wQFMAMBAf8wDQYJKoZIhvcNAQEEBQADgYEAgozj7BkD9O8si2V0v+EZ/t7E
fz/LC8y6mD7IBUziHy5/53ymGAGLtyhXHvX+UIE6UWbHro3IqVkrmY5uC93Z2Wew
A/6edK3KFUcUikrLeewM7gmqsiASEKx2mKRKlu12jXyNS5tXrPWRDvUKtFC1uL9a
12rFAQS2BkIk7aU+ghYxAA==
-----END PKCS7-----
</code></pre><p>&#x5C06;&#x5176;&#x5B58;&#x50A8;&#x4E3A;zlex.p7b </p>
<ol>
<li><p>&#x5C06;&#x7531;CA&#x7B7E;&#x53D1;&#x7684;&#x8BC1;&#x4E66;&#x5BFC;&#x5165;&#x5BC6;&#x94A5;&#x5E93;&#x3002;</p>
<p> keytool -import -trustcacerts -alias www.zlex.org -file d:\zlex.p7b -keystore d:\zlex.keystore -v</p>
</li>
</ol>
<p>&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x7684;&#x5BC6;&#x7801;&#x4E3A; 123456 </p>
<p>&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;keystore&#x5BC6;&#x7801;&#xFF1A;

&#x56DE;&#x590D;&#x4E2D;&#x7684;&#x6700;&#x9AD8;&#x7EA7;&#x8BA4;&#x8BC1;&#xFF1A;

&#x6240;&#x6709;&#x8005;:CN=Thawte Test CA Root, OU=TEST TEST TEST, O=Thawte Certification, ST=FOR
 TESTING PURPOSES ONLY, C=ZA
&#x7B7E;&#x53D1;&#x4EBA;:CN=Thawte Test CA Root, OU=TEST TEST TEST, O=Thawte Certification, ST=FOR
 TESTING PURPOSES ONLY, C=ZA
&#x5E8F;&#x5217;&#x53F7;:0
&#x6709;&#x6548;&#x671F;: Thu Aug 01 08:00:00 CST 1996 &#x81F3;Fri Jan 01 05:59:59 CST 2021
&#x8BC1;&#x4E66;&#x6307;&#x7EB9;:
         MD5:5E:E0:0E:1D:17:B7:CA:A5:7D:36:D6:02:DF:4D:26:A4
         SHA1:39:C6:9D:27:AF:DC:EB:47:D6:33:36:6A:B2:05:F1:47:A9:B4:DA:EA
         &#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#x540D;&#x79F0;:MD5withRSA
         &#x7248;&#x672C;: 3

&#x6269;&#x5C55;:

#1: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:true
  PathLen:2147483647
]


... &#x662F;&#x4E0D;&#x53EF;&#x4FE1;&#x7684;&#x3002; &#x8FD8;&#x662F;&#x8981;&#x5B89;&#x88C5;&#x56DE;&#x590D;&#xFF1F; [&#x5426;]&#xFF1A;  Y
&#x8BA4;&#x8BC1;&#x56DE;&#x590D;&#x5DF2;&#x5B89;&#x88C5;&#x5728; keystore&#x4E2D;
[&#x6B63;&#x5728;&#x5B58;&#x50A8; d:\zlex.keystore]
</code></pre><ol>
<li>&#x57DF;&#x540D;&#x5B9A;&#x4F4D; </li>
</ol>
<p>&#x5C06;&#x57DF;&#x540D;www.zlex.org&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#x4E0A;&#x3002;&#x6253;&#x5F00;<code>C:\Windows\System32\drivers\etc\hosts</code>&#x6587;&#x4EF6;&#xFF0C;&#x5C06; www.zlex.org&#x7ED1;&#x5B9A;&#x5728;&#x672C;&#x673A;&#x4E0A;&#x3002;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x8FFD;&#x52A0;<code>127.0.0.1       www.zlex.org</code>&#x3002;&#x73B0;&#x5728;&#x901A;&#x8FC7;&#x5730;&#x5740;&#x680F;&#x8BBF;&#x95EE;<a href="http://www.zlex.org&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;ping&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#xFF0C;&#x57DF;&#x540D;&#x6620;&#x5C04;&#x5C31;&#x641E;&#x5B9A;&#x4E86;&#x3002;" target="_blank">http://www.zlex.org&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7;ping&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x672C;&#x673A;&#xFF0C;&#x57DF;&#x540D;&#x6620;&#x5C04;&#x5C31;&#x641E;&#x5B9A;&#x4E86;&#x3002;</a> </p>
<ol>
<li>&#x914D;&#x7F6E;server.xml</li>
</ol>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span>
            <span class="hljs-attr">keystoreFile</span>=<span class="hljs-string">&quot;conf/zlex.keystore&quot;</span>
            <span class="hljs-attr">keystorePass</span>=<span class="hljs-string">&quot;123456&quot;</span> 
            <span class="hljs-attr">truststoreFile</span>=<span class="hljs-string">&quot;conf/zlex.keystore&quot;</span>    
            <span class="hljs-attr">truststorePass</span>=<span class="hljs-string">&quot;123456&quot;</span>     
            <span class="hljs-attr">SSLEnabled</span>=<span class="hljs-string">&quot;true&quot;</span>
            <span class="hljs-attr">URIEncoding</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>
            <span class="hljs-attr">clientAuth</span>=<span class="hljs-string">&quot;false&quot;</span>            
            <span class="hljs-attr">maxThreads</span>=<span class="hljs-string">&quot;150&quot;</span>
            <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;443&quot;</span>
            <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;HTTP/1.1&quot;</span>
            <span class="hljs-attr">scheme</span>=<span class="hljs-string">&quot;https&quot;</span>
            <span class="hljs-attr">secure</span>=<span class="hljs-string">&quot;true&quot;</span>
            <span class="hljs-attr">sslProtocol</span>=<span class="hljs-string">&quot;TLS&quot;</span> /&gt;</span>
</code></pre>
<p>&#x5C06;&#x6587;&#x4EF6;zlex.keystore&#x62F7;&#x8D1D;&#x5230;tomcat&#x7684;conf&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x91CD;&#x65B0;&#x542F;&#x52A8;tomcat&#x3002;&#x8BBF;&#x95EE;<a href="https://www.zlex.org/&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8054;&#x7F51;&#x6709;&#x4E9B;&#x8FDF;&#x949D;&#x3002;&#x5927;&#x7EA6;5&#x79D2;&#x949F;&#x540E;&#xFF0C;&#x7F51;&#x9875;&#x6B63;&#x5E38;&#x663E;&#x793A;&#xFF0C;&#x540C;&#x65F6;&#x6709;&#x5982;&#x4E0B;&#x56FE;&#x793A;&#xFF1A;" target="_blank">https://www.zlex.org/&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8054;&#x7F51;&#x6709;&#x4E9B;&#x8FDF;&#x949D;&#x3002;&#x5927;&#x7EA6;5&#x79D2;&#x949F;&#x540E;&#xFF0C;&#x7F51;&#x9875;&#x6B63;&#x5E38;&#x663E;&#x793A;&#xFF0C;&#x540C;&#x65F6;&#x6709;&#x5982;&#x4E0B;&#x56FE;&#x793A;&#xFF1A;</a></p>
<p><img src="images/ca-003.jpg" alt=""></p>
<p>&#x6D4F;&#x89C8;&#x5668;&#x9A8C;&#x8BC1;&#x4E86;&#x8BE5;CA&#x673A;&#x6784;&#x7684;&#x6709;&#x6548;&#x6027;&#x3002; </p>
<p>&#x6253;&#x5F00;&#x8BC1;&#x4E66;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A; </p>
<p><img src="images/ca-004.jpg" alt=""></p>
<p>&#x8C03;&#x6574;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF1A; </p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.Assert.*;

<span class="hljs-keyword">import</span> java.io.DataInputStream;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.net.URL;

<span class="hljs-keyword">import</span> javax.net.ssl.HttpsURLConnection;

<span class="hljs-keyword">import</span> org.junit.Test;

<span class="hljs-comment">/**
 * 
 * <span class="hljs-doctag">@author</span> &#x6881;&#x680B;
 * <span class="hljs-doctag">@version</span> 1.0
 * <span class="hljs-doctag">@since</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateCoderTest</span> </span>{
    <span class="hljs-keyword">private</span> String password = <span class="hljs-string">&quot;123456&quot;</span>;
    <span class="hljs-keyword">private</span> String alias = <span class="hljs-string">&quot;www.zlex.org&quot;</span>;
    <span class="hljs-keyword">private</span> String certificatePath = <span class="hljs-string">&quot;d:/zlex.cer&quot;</span>;
    <span class="hljs-keyword">private</span> String keyStorePath = <span class="hljs-string">&quot;d:/zlex.keystore&quot;</span>;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x516C;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x79C1;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);
        String inputStr = <span class="hljs-string">&quot;Ceritifcate&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encrypt = CertificateCoder.encryptByPublicKey(data,
                certificatePath);

        <span class="hljs-keyword">byte</span>[] decrypt = CertificateCoder.decryptByPrivateKey(encrypt,
                keyStorePath, alias, password);
        String outputStr = <span class="hljs-keyword">new</span> String(decrypt);

        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x6570;&#x636E;&#x4E00;&#x81F4;</span>
        assertArrayEquals(data, decrypt);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x8BC1;&#x4E66;&#x6709;&#x6548;</span>
        assertTrue(CertificateCoder.verifyCertificate(certificatePath));

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSign</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x52A0;&#x5BC6;&#x2014;&#x2014;&#x516C;&#x94A5;&#x89E3;&#x5BC6;&quot;</span>);

        String inputStr = <span class="hljs-string">&quot;sign&quot;</span>;
        <span class="hljs-keyword">byte</span>[] data = inputStr.getBytes();

        <span class="hljs-keyword">byte</span>[] encodedData = CertificateCoder.encryptByPrivateKey(data,
                keyStorePath, alias, password);

        <span class="hljs-keyword">byte</span>[] decodedData = CertificateCoder.decryptByPublicKey(encodedData,
                certificatePath);

        String outputStr = <span class="hljs-keyword">new</span> String(decodedData);
        System.err.println(<span class="hljs-string">&quot;&#x52A0;&#x5BC6;&#x524D;: &quot;</span> + inputStr + <span class="hljs-string">&quot;\n\r&quot;</span> + <span class="hljs-string">&quot;&#x89E3;&#x5BC6;&#x540E;: &quot;</span> + outputStr);
        assertEquals(inputStr, outputStr);

        System.err.println(<span class="hljs-string">&quot;&#x79C1;&#x94A5;&#x7B7E;&#x540D;&#x2014;&#x2014;&#x516C;&#x94A5;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&quot;</span>);
        <span class="hljs-comment">// &#x4EA7;&#x751F;&#x7B7E;&#x540D;</span>
        String sign = CertificateCoder.sign(encodedData, keyStorePath, alias,
                password);
        System.err.println(<span class="hljs-string">&quot;&#x7B7E;&#x540D;:\r&quot;</span> + sign);

        <span class="hljs-comment">// &#x9A8C;&#x8BC1;&#x7B7E;&#x540D;</span>
        <span class="hljs-keyword">boolean</span> status = CertificateCoder.verify(encodedData, sign,
                certificatePath);
        System.err.println(<span class="hljs-string">&quot;&#x72B6;&#x6001;:\r&quot;</span> + status);
        assertTrue(status);

    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHttps</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        URL url = <span class="hljs-keyword">new</span> URL(<span class="hljs-string">&quot;https://www.zlex.org/examples/&quot;</span>);
        HttpsURLConnection conn = (HttpsURLConnection) url.openConnection();

        conn.setDoInput(<span class="hljs-keyword">true</span>);
        conn.setDoOutput(<span class="hljs-keyword">true</span>);

        CertificateCoder.configSSLSocketFactory(conn, password, keyStorePath,
                keyStorePath);

        InputStream is = conn.getInputStream();

        <span class="hljs-keyword">int</span> length = conn.getContentLength();

        DataInputStream dis = <span class="hljs-keyword">new</span> DataInputStream(is);
        <span class="hljs-keyword">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[length];
        dis.readFully(data);

        dis.close();
        conn.disconnect();
        System.err.println(<span class="hljs-keyword">new</span> String(data));
    }
}
</code></pre>
<p>&#x518D;&#x6B21;&#x6267;&#x884C;&#xFF0C;&#x9A8C;&#x8BC1;&#x901A;&#x8FC7;&#xFF01; 
&#x7531;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x4E86;&#x57FA;&#x4E8E;SSL&#x534F;&#x8BAE;&#x7684;&#x8BA4;&#x8BC1;&#x8FC7;&#x7A0B;&#x3002;&#x6D4B;&#x8BD5;&#x7C7B;&#x7684;testHttps&#x65B9;&#x6CD5;&#x6A21;&#x62DF;&#x4E86;&#x4E00;&#x6B21;&#x6D4F;&#x89C8;&#x5668;&#x7684;HTTPS&#x8BBF;&#x95EE;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Java中的各种加密算法 BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC","level":"1.2.1","depth":2,"next":{"title":"OS","level":"1.3","depth":1,"ref":"","articles":[{"title":"ubuntu","level":"1.3.1","depth":2,"ref":"","articles":[{"title":"mac系统制作ubuntu启动盘","level":"1.3.1.1","depth":3,"path":"mac系统制作ubuntu启动盘.md","ref":"mac系统制作ubuntu启动盘.md","articles":[]}]}]},"previous":{"title":"算法","level":"1.2","depth":1,"ref":"","articles":[{"title":"Java中的各种加密算法 BASE64 MD5 SHA HMAC DES PBE RSA DH DSA ECC","level":"1.2.1","depth":2,"path":"crypto/java的各种加密算法.md","ref":"crypto/java的各种加密算法.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["anchor-navigation-ex","new-flowchart","sequence"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"sequence":{"theme":"simple"},"new-flowchart":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"morya","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"mynotes","links":{"sidebar":{}},"gitbook":"*"},"file":{"path":"crypto/java的各种加密算法.md","mtime":"2017-03-26T12:49:32.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-11-27T15:42:49.870Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src='/gitbook/gitbook-plugin-new-flowchart/raphael-min.js'></script>
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-new-flowchart/flowchart-1.6.2.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-new-flowchart/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    


    </body>
</html>

